(this["webpackJsonpreact-social"]=this["webpackJsonpreact-social"]||[]).push([[0],{312:function(e,t,n){},339:function(e,t,n){},358:function(e,t,n){},359:function(e,t,n){},389:function(e,t){},391:function(e,t){},401:function(e,t){},403:function(e,t){},429:function(e,t){},431:function(e,t){},432:function(e,t){},437:function(e,t){},439:function(e,t){},445:function(e,t){},447:function(e,t){},466:function(e,t){},478:function(e,t){},481:function(e,t){},602:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=602},605:function(e,t){},607:function(e,t){},640:function(e,t,n){},641:function(e,t,n){},642:function(e,t,n){},643:function(e,t,n){},644:function(e,t,n){},645:function(e,t,n){},646:function(e,t,n){},647:function(e,t,n){},648:function(e,t,n){},649:function(e,t,n){},650:function(e,t,n){},651:function(e,t,n){},652:function(e,t,n){},653:function(e,t,n){},654:function(e,t,n){},655:function(e,t,n){},656:function(e,t,n){},657:function(e,t,n){},658:function(e,t,n){},659:function(e,t,n){},660:function(e,t,n){},661:function(e,t,n){},662:function(e,t,n){},665:function(e,t,n){},666:function(e,t,n){},667:function(e,t,n){},668:function(e,t,n){},669:function(e,t,n){},670:function(e,t,n){},671:function(e,t,n){},672:function(e,t,n){},673:function(e,t,n){},674:function(e,t,n){},675:function(e,t,n){},676:function(e,t,n){},692:function(e,t,n){},693:function(e,t,n){},694:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(29),s=n.n(a),i=n(11),o=n(325),l=n(322),u="LOGIN_SUCCESS",d="LOGIN_START",j="LOGIN_FAILED",b="UPDATE_USER",f="UN_FOLLOW",v="FOLLOW",O="UPDATE_BACKGROUND_USER",m="UPDATE_AVATAR_USER",p="ADD_FRIEND",h="REMOVE_FRIEND",x="USER_LOGOUT",g="SET_TYPE",N="SET_LIST_FRIEND_REQUEST",y="ADD_LIST_FRIEND_REQUEST",_="REMOVE_FRIEND_REQUEST",C="INCREASE_NUMBER_FRIEND_REQUEST",k="SET_NUMBER_FRIEND_REQUEST",I="SET_FILES",w="ADD_FILE",A="REMOVE_FILE",E="UPDATE_LAST_MESSAGE",S="UPDATE_STATUS_CONVERSATION",R="SET_STATUS_CONVERSATION",T="SET_CHAT",F="SET_LIST_CONVERSATION",L="SET_CONVERSATION_CHAT",D="SET_IS_SHOW",P="UPDATE_CONVERSATION_DISPLAYS",U="UPDATE_FRIEND_CHAT",M="ADD_CONVERSATION",q="SET_NUMBER_UNREAD",B="INCREASE_NUMBER_UNREAD",V="DECREASE_NUMBER_UNREAD",Q="UPDATE_READ_CONVERSATION",J="SET_NEW_CONVERSATION_CHAT",Y="SET_SOCKET",H="SET_USERS_ONLINE",K="ADD_USER_ONLINE",G="REMOVE_USER_OFFLINE",W="RESET_NETWORK",Z="SET_LIST_NOTIFICATION",X="ADD_NOTIFICATION",z="SET_NUMBER_NOTIFICATION_UNREAD",$="INCREASE_NUMBER_NOTIFICATION_UNREAD",ee="DECREASE_NUMBER_NOTIFICATION_UNREAD",te="SET_SHOW_NOTIFICATION",ne="REMOVE_NOTIFICATION",ce="SET_TYPE_NOTIFICATION",re="SET_NOTIFICATIONs_DISPLAY",ae="REMOVE_ALL_NOTIFICATION",se="UPDATE_LIST_CONVERSATION",ie="ADD_NOTIFICATION_DISPLAY",oe="SET_SHOW_NOTIFICATION_MENU",le="SET_STATUS_FRIEND",ue="SET_USER_PROFILE",de="SET_IS_ME",je="SET_CALL",be="END_CALL",fe="SET_IS_ANSWER",ve="SET_FRIEND_INVITES",Oe="REFUSE_INVITE",me="SET_ACCEPT_INVITE",pe="SET_USER_STREAM",he="SET_IS_COMPLETE",xe="UPDATE_CONVERSATION",ge="SET_PEER",Ne="SET_CREATE_ROOM",ye="ADD_FRIEND_TO_ROOM",_e="REMOVE_FRIEND_TO_ROOM",Ce="SET_LIST_FRIEND",ke="RESET_CREATE_ROOM",Ie=n(4),we=n(2),Ae=n(3),Ee=n(6),Se=n(5),Re=n(9),Te="https://tse4.mm.bing.net/th?id=OIP.VwOipFm0fDDr_KOzoyrgVwAAAA&pid=Api&P=0&w=169&h=178",Fe="https://file.vfo.vn/hinh/2018/03/hinh-mau-trang-tinh-tron-hinh-nen-anh-dai-dien-anh-bia-toan-mau-trang4.png",Le="http://localhost:8080/images/",De=(n(339),n(0)),Pe=function(){return Object(De.jsxs)("nav",{children:[Object(De.jsx)("img",{src:Le+"logo.png",alt:""}),Object(De.jsxs)("ul",{children:[Object(De.jsx)("li",{children:Object(De.jsx)("img",{src:Le+"live.png",alt:"",className:"icon_modal-active"})}),Object(De.jsx)("li",{children:Object(De.jsx)("img",{src:Le+"video.png",alt:""})}),Object(De.jsx)("li",{children:Object(De.jsx)("img",{src:Le+"message.png",alt:""})}),Object(De.jsx)("li",{children:Object(De.jsx)("img",{src:Le+"notification.png",alt:""})}),Object(De.jsx)("li",{children:Object(De.jsx)("img",{src:Le+"users.png",alt:""})}),Object(De.jsx)("li",{children:Object(De.jsx)("img",{src:Le+"setting.png",alt:""})})]})]})},Ue=n(7),Me=n(63),qe=n.n(Me),Be=n(127),Ve="access_token",Qe="refresh_token",Je=qe.a.create({baseURL:"http://localhost:8080/v1/api"}),Ye=function(e){if(!e)return!0;var t=new Date;return Object(Be.a)(e).exp<t.getTime()/1e3},He=function(e){return localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):""},Ke=null,Ge=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=He(Qe),!Ye(t)){e.next=4;break}throw new Error("Refresh token invalid");case 4:return e.next=6,qe.a.post("http://localhost:8080/v1/api/auth/refresh-token",{refreshToken:t});case 6:return n=e.sent,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();Je.interceptors.request.use(function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n,c,r;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=He(Ve)){e.next=3;break}throw new Error("Please login");case 3:if(!Ye()){e.next=17;break}return e.prev=4,Ke=Ke||Ge(),e.next=8,Ke;case 8:c=e.sent,r=c.data.newAccessToken,localStorage.setItem(Ve,JSON.stringify(r)),n=r,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(4),new Error("Refresh Token failed");case 17:return t.headers.Authorization="Bearer "+n,e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){return Promise.reject(e)})),Je.interceptors.response.use((function(e){return e.data}),(function(e){var t,n;console.log("error on respon",e);var c=(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.message)||e.message;return Re.b.error(c,{autoClose:1e3}),Promise.reject(c)}));var We=Je,Ze=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.get("".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xe=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t,n){var c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.post("".concat(t),n);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ze=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t,n){var c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.put("".concat(t),n);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$e=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t,n){var c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.patch("".concat(t),n);case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),et=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,We.delete("".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),tt=n(21),nt=n(48),ct=function(e,t){var n=Object(nt.a)(e).replace("seconds","gi\xe2y"),c=(n=(n=(n=n.replace("minutes","ph\xfat")).replace("hours","gi\u1edd")).replace("days","ng\xe0y")).indexOf(" ago");return t?n.slice(0,c):n},rt=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(c.useMemo)((function(){if(null!==e&&void 0!==e&&e.lastLogin)return ct(e.lastLogin,t)}),[e])},at=(n(358),function(e){var t=e.isOnline,n=e.time,c=e.padding;return Object(De.jsx)("span",{className:"active ".concat(t?"online":"offline"),style:{padding:c},children:!t&&n})}),st=(n(359),n(194));n(622).config(),st.config({cloud_name:"ko-c",api_key:"859769854664576",api_secret:"4IajgOMmiGtm4j3D-kz7AhqyiCw"});var it=st,ot=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all(t.map((function(e){var t=new FormData;return e.camera?t.append("file",e.url):t.append("file",e),t.append("upload_preset","react-social"),qe.a.post("https://api.cloudinary.com/v1_1/ko-c/image/upload",t)})));case 3:return n=e.sent,e.abrupt("return",n.map((function(e){var t=e.data;return{url:t.url,public_id:t.public_id}})));case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),lt=function(e){try{e.map((function(e){return it.uploader.destroy(e,(function(e,t){if(t)throw t}))}))}catch(t){throw t}},ut=function(e,t){var n=Object(c.useState)(!1),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(Ie.c)((function(e){return e.network})).usersOnline,o=Object(Ie.c)((function(e){return e.auth})).userCurrent;return Object(c.useEffect)((function(){return(null===o||void 0===o?void 0:o._id)===(null===e||void 0===e?void 0:e._id)?s(!0):i&&i.length>0?s(i.includes(null===e||void 0===e?void 0:e._id)):void s(!1)}),[i,e,o]),[a,s]},dt=function(e){var t=e.isStatus,n=void 0===t||t,r=e.user,a=e.width,s=e.height,i=e.link,o=void 0===i||i,l=e.isShowOffline,u=void 0===l||l,d=e.className,j=void 0===d?"":d,b=Object(c.useState)(),f=Object(Se.a)(b,2),v=f[0],O=f[1],m=ut(r),p=Object(Se.a)(m,2),h=p[0],x=(p[1],Object(Ie.c)((function(e){return e.auth})).userCurrent);Object(c.useEffect)((function(){x&&r&&O(x._id===r._id||x.friends.includes(r._id))}),[r,x]);var g=rt(r),N=Object(c.useMemo)((function(){return function(e){var t;return(null===e||void 0===e||null===(t=e.profilePicture)||void 0===t?void 0:t.length)&&(null===e||void 0===e?void 0:e.profilePicture[0])||Te}(r)}),[r]);return Object(De.jsx)(De.Fragment,{children:o?Object(De.jsxs)(tt.b,{to:"/profile/".concat(null===r||void 0===r?void 0:r._id),style:{width:a,height:s},className:"avatarContainer ".concat(j),children:[Object(De.jsx)("img",{className:"avatarImg",src:N,alt:""}),v&&n?u?g&&Object(De.jsx)(at,{isOnline:h,time:g}):h&&g&&Object(De.jsx)(at,{isOnline:h,time:g}):Object(De.jsx)(De.Fragment,{})]}):Object(De.jsxs)("div",{className:"avatarContainer ".concat(j),style:{width:a,height:s},children:[Object(De.jsx)("img",{className:"avatarImg",src:N,alt:""}),v&&n?u?g&&Object(De.jsx)(at,{isOnline:h,time:g}):h&&g&&Object(De.jsx)(at,{isOnline:h,time:g}):Object(De.jsx)(De.Fragment,{})]})})},jt=function(e){var t=e.friend,n=Object(c.useState)(!1),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(Ie.c)((function(e){return e.auth})).userCurrent,o=Object(Ie.c)((function(e){return e.network})).socket,l=Object(Ie.c)((function(e){return e.call})),u=l.isVideo,d=l.roomCallId,j=l.conversationId,b=Object(c.useRef)();Object(c.useEffect)((function(){if(a&&!b.current){var e=new Date;b.current=3e5+e.getTime();var t=setTimeout((function(){s(!1),b.current=""}),1e3);return function(){return clearTimeout(t)}}}),[a]);return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(dt,{width:"60px",height:"60px",user:t,link:!1,isShowOffline:!1}),Object(De.jsx)("p",{children:null===t||void 0===t?void 0:t.userName}),Object(De.jsx)("button",{type:"button",className:"btn btn-info",onClick:function(e){if(a)return Re.b.info("Already invited this friend ".concat(Object(nt.a)(b.current)," later can invite again"),{autoClose:1e3});o&&i&&(o.emit("createCall",{isVideo:u,sender:{profilePicture:i.profilePicture,userName:i.userName,_id:null===i||void 0===i?void 0:i._id},receiverId:null===t||void 0===t?void 0:t._id,roomCallId:d,isCreate:!1,conversationId:j}),s(!0))},children:a?"Invited":"Invite"})]})},bt=n(128),ft=n.n(bt),vt=(n(638),n(639),n(640),function(e){var t=e.children,n=Object(c.useMemo)((function(){return{dots:!0,infinite:!0,speed:500,slidesToShow:3,slidesToScroll:1,lazyLoad:!0,responsive:[{breakpoint:1024,settings:{slidesToShow:3,slidesToScroll:3,infinite:!0,dots:!0}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:2,initialSlide:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]}}),[]);return Object(De.jsx)(ft.a,Object(we.a)(Object(we.a)({},n),{},{children:t}))}),Ot=(n(641),function(){var e=Object(Ie.c)((function(e){return e.call})),t=e.userCall,n=e.isAnswer,r=e.fristLoadFriends,a=e.friendInvites,s=Object(Ie.c)((function(e){return e.auth})).userCurrent,i=Object(Ie.b)();Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r,a;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!s||!s._id){n.next=14;break}return n.prev=1,n.next=4,Ze("/user/get-friends/".concat(null===s||void 0===s?void 0:s._id));case 4:c=n.sent,c.message,r=c.friends,a=Object(Ue.a)(r),t&&(a=r.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==t._id}))),e&&i({type:ve,payload:a}),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(1),console.log("err",n.t0);case 14:case"end":return n.stop()}}),n,null,[[1,11]])})));return function(){return n.apply(this,arguments)}}();return r&&n(),function(){return e=!1}}),[s,n]);var o=Object(c.useMemo)((function(){return{dots:!0,infinite:!0,speed:500,slidesToShow:3,slidesToScroll:1}})),l=function(e){return a.map((function(t){return Object(De.jsx)("div",{children:Object(De.jsx)("div",{className:"friend_invite "+e,children:Object(De.jsx)(jt,{friend:t})})},null===t||void 0===t?void 0:t._id)}))};return Object(De.jsxs)("div",{className:"invite",children:[Object(De.jsx)("p",{className:"title",children:"Invite More People"}),a.length<=3?Object(De.jsx)("div",{className:"invite_content",children:l("no-slider")}):Object(De.jsx)(ft.a,Object(we.a)(Object(we.a)({},o),{},{children:l()}))]})}),mt=(n(642),n(731)),pt=function(e,t){e.split(" ").forEach((function(e){t.classList.add(e)}))},ht=function(e,t,n){n.classList.contains(e)?n.classList.replace(e,t):n.classList.replace(t,e)},xt=function(e){var t={video:e,audio:!0};return navigator.mediaDevices.getUserMedia(t)},gt=function(e){return Array.from(document.querySelectorAll(".video")).find((function(t){return t.getAttribute("streamId")===e}))},Nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&!gt(e.id)){var n=document.createElement("div"),c=document.createElement("img");c.style.display="none",n.setAttribute("streamId",null===e||void 0===e?void 0:e.id);var r=document.createElement("i");pt("fa-solid fa-thumbtack icon_video",r),n.classList.add("video"),t&&n.classList.add("you_video");var a=document.createElement("video");a.srcObject=e,a.addEventListener("loadedmetadata",(function(){a.play()})),r.onclick=function(e){var t=document.querySelector(".video.pin");if(r.classList.contains("fa-thumbtack")){if(t){t.classList.remove("pin");var c=t.querySelector(".icon_video");ht("fa-thumbtack","fa-circle-xmark",c)}n.classList.add("pin")}else n.classList.remove("pin");ht("fa-thumbtack","fa-circle-xmark",e.target)},n.append(a),n.append(c),n.append(r),document.querySelector(".video-joins").append(n)}},yt=function(e){var t=e.img,n=e.streamId,c=gt(n);if(c){var r=c.querySelector("video"),a=c.querySelector("img");r&&a&&(t?(r.style.display="none",r.pause(),a.src=t,a.style.display="block"):(r.style.display="block",r.play(),a.src="",a.style.display="none"))}},_t=function(){var e=Object(Ie.c)((function(e){return e.call})).userSendCall,t=Object(c.useState)(20),n=Object(Se.a)(t,2),r=n[0],a=n[1],s=Object(Ie.c)((function(e){return e.auth})).userCurrent,i=Object(Ie.c)((function(e){return e.network})).socket,o=Object(Ie.c)((function(e){return e.peer})),l=Object(Ie.c)((function(e){return e.call})),u=l.isAnswer,d=l.roomCallId,j=l.isVideo,b=(l.isCreate,l.userStream,l.conversationId),f=Object(Ie.b)();Object(c.useEffect)((function(){if(!u){if(!r)return O();var e=function(){return a((function(e){return e-1}))},t=setTimeout(e,1e3);return function(){return clearTimeout(t,e)}}}),[r,u]);var v=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f({type:fe,payload:!0}),t.next=3,xt(j);case 3:if(n=t.sent,f({type:pe,payload:n}),Nt(n,!0),i){t.next=8;break}return t.abrupt("return");case 8:i.emit("joinRoomCall",{userSendCall:null===e||void 0===e?void 0:e._id,userReceiveCall:null===s||void 0===s?void 0:s._id,roomCallId:d,peerId:o._id,isCreate:!1,conversationId:b,userName:null===s||void 0===s?void 0:s.userName,streamId:n.id});case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),O=function(){f({type:Oe}),null===i||void 0===i||i.emit("refuseInviteCall",null===s||void 0===s?void 0:s._id)};return Object(De.jsxs)("div",{className:"modalInvite_content",children:[Object(De.jsx)("span",{className:"close",onClick:O,children:"\xd7"}),Object(De.jsxs)("div",{className:"info",children:[Object(De.jsx)(dt,{user:e,link:!1,isStatus:!1}),Object(De.jsx)("div",{className:"noMes",children:"".concat(null===e||void 0===e?void 0:e.userName," Invited you to join the call")})]}),Object(De.jsxs)("div",{className:"buttons",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-danger",onClick:O,children:"Cancel"}),Object(De.jsx)("button",{type:"button",className:"btn btn-primary",onClick:v,children:"Join ".concat(r)})]})]})},Ct=function(){var e=Object(Ie.c)((function(e){return e.network})).socket,t=Object(Ie.c)((function(e){return e.call})),n=t.isVideo,c=t.userSendCall,r=t.isSenderCall,a=t.isAnswer,s=t.roomCallId,i=t.conversationId,o=Object(Ie.c)((function(e){return e.peer})),l=Object(Ie.c)((function(e){return e.auth})).userCurrent,u=Object(Ie.b)(),d=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var r;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u({type:fe,payload:!0}),t.prev=1,t.next=4,xt(n);case 4:if(r=t.sent,u({type:pe,payload:r}),Nt(r,!0),e){t.next=9;break}return t.abrupt("return");case 9:e.emit("joinRoomCall",{userSendCall:null===c||void 0===c?void 0:c._id,userReceiveCall:null===l||void 0===l?void 0:l._id,roomCallId:s,peerId:o._id,isCreate:!0,conversationId:i,isVideo:n,userName:null===l||void 0===l?void 0:l.userName,streamId:r.id}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("err",{err:t.t0});case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}();return Object(De.jsxs)("div",{className:"call_box",children:[Object(De.jsxs)("div",{className:"text-center call_info",style:{padding:"40px 0"},children:[Object(De.jsx)(dt,{width:"150px",height:"150px",user:c,link:!1,isStatus:!1}),Object(De.jsx)("h4",{children:null===c||void 0===c?void 0:c.userName})]}),!a&&Object(De.jsx)("div",{children:n?Object(De.jsx)("span",{children:"calling video..."}):Object(De.jsx)("span",{children:"calling audio..."})}),Object(De.jsxs)("div",{className:"call_menu",children:[Object(De.jsx)("i",{className:"fa-solid fa-phone-slash text-danger",onClick:function(){e.emit("userRefuseCall",{userRefuseId:null===l||void 0===l?void 0:l._id,receiverId:null===c||void 0===c?void 0:c._id,isCreate:!0}),u({type:be})}}),!r&&!a&&Object(De.jsx)("i",{className:"fa-solid fa-phone-flip",onClick:d})]})]})},kt=function(){var e=Object(c.useState)(0),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)(0),u=Object(Se.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(0),f=Object(Se.a)(b,2),v=f[0],O=f[1],m=Object(c.useState)(!0),p=Object(Se.a)(m,2),h=p[0],x=p[1],g=Object(c.useState)(!0),N=Object(Se.a)(g,2),y=N[0],_=N[1],C=Object(Ie.c)((function(e){return e.call})),k=C.isVideo,I=C.userReciverCall,w=C.isAnswer,A=C.isCreate,E=C.roomCallId,S=C.isSenderCall,R=C.userStream,T=C.conversationId,F=Object(Ie.c)((function(e){return e.network})).socket,L=Object(Ie.c)((function(e){return e.peer})),D=Object(Ie.c)((function(e){return e.auth})).userCurrent,P=Object(Ie.b)();Object(c.useEffect)((function(){j(v%60),o(parseInt(v/60)),r(parseInt(v/3600))}),[v]),Object(c.useEffect)((function(){if(L&&R)return L.on("call",(function(e){e.answer(R),e.on("stream",(function(e){Nt(e)}))})),function(){return L.removeListener("call")}}),[R,L]),Object(c.useEffect)((function(){var e=setInterval((function(){return O((function(e){return e+1}))}),1e3);return function(){O(0),clearInterval(e)}}),[]),Object(c.useEffect)((function(){var e=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n,c,r,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.peerId,c=t.userName,Re.b.info("".concat(c," joined the call"),{autoClose:1e3}),R){e.next=9;break}return e.next=5,xt(k);case 5:r=e.sent,P({type:pe,payload:r}),e.next=10;break;case 9:r=R;case 10:if(a=L.call(n,r),w||(P({type:fe,payload:!0}),Nt(r,!0)),a){e.next=14;break}return e.abrupt("return");case 14:a.on("stream",(function(e){Nt(e)}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return F.on("user-joined-call",e),function(){return null===F||void 0===F?void 0:F.off("user-joined-call",e)}}),[F,R,w]),Object(c.useEffect)((function(){var e=function(e){var t=e.streamId,n=e.userName;Re.b.info("".concat(n," got off the call"),{autoClose:1e3});var c=gt(t);c&&c.remove()};return F.on("user-call-out",e),function(){return null===F||void 0===F?void 0:F.off("user-call-out",e)}}),[F]),Object(c.useEffect)((function(){if(F){var e=function(e,t){Re.b.info(e,{autoClose:500}),t&&P({type:be})};return F.on("callRefused",(function(){e("".concat(null===I||void 0===I?void 0:I.userName," refuse the call"))})),F.on("userCallBusy",(function(t){e("".concat(I.userName," is on another call!"),t)})),function(){null===F||void 0===F||F.off("userCallBusy"),null===F||void 0===F||F.off("callRefused")}}}),[F,I]),Object(c.useEffect)((function(){if(F)return F.on("update-user-camera",yt),function(){return null===F||void 0===F?void 0:F.off("update-user-camera",yt)}}),[F]),Object(c.useEffect)((function(){if(!w){var e=setTimeout((function(){S&&(null===F||void 0===F||F.emit("userCallNoReaction",{userCallId:I._id,userSendCallId:D._id,conversationId:T,isVideo:k})),P({type:be})}),1e4);return function(){return clearTimeout(e)}}O(0)}),[w]);var U=function(e){if(R){var t=R.getTracks().find((function(t){return t.kind===e}));if(t){var n={};t.enabled?("video"===e&&(n.img=null!==D&&void 0!==D&&D.profilePicture.length?null===D||void 0===D?void 0:D.profilePicture[0]:Te),t.enabled=!1):t.enabled=!0,"video"===e&&(n.streamId=null===R||void 0===R?void 0:R.id,n.roomCallId=E,F.emit("user-turn-off-video",Object(we.a)({},n)),yt(n))}}};return Object(De.jsxs)("div",{className:"call_modal",children:[Object(De.jsx)("div",{className:"modal_container",style:{display:w?"none":"flex"},children:!w&&(A?Object(De.jsx)(Ct,{}):Object(De.jsx)(_t,{}))}),Object(De.jsxs)("div",{className:"header",style:{display:"".concat(w?"block":"none")},children:[Object(De.jsx)(Pe,{}),Object(De.jsxs)("div",{className:"container",children:[Object(De.jsxs)("div",{className:"top-icons",children:[Object(De.jsx)("img",{src:Le+"search.png",alt:""}),Object(De.jsx)("img",{src:Le+"menu.png",alt:""})]}),Object(De.jsxs)("div",{className:"video_layout",children:[Object(De.jsxs)("div",{className:"content_left",children:[Object(De.jsx)("div",{className:"pin_video border_center"}),Object(De.jsxs)("div",{className:"time_video",children:[Object(De.jsx)("span",{children:n.toString().length<2?"0"+n:n}),Object(De.jsx)("span",{children:":"}),Object(De.jsx)("span",{children:i.toString().length<2?"0"+i:i}),Object(De.jsx)("span",{children:":"}),Object(De.jsx)("span",{children:d.toString().length<2?"0"+d:d})]}),Object(De.jsxs)("div",{className:"controls",children:[Object(De.jsx)("div",{className:"icon-control",children:Object(De.jsx)("img",{src:Le+"chat.png",alt:""})}),Object(De.jsx)("div",{className:"icon-control",onClick:function(){U("video"),_((function(e){return!e}))},children:y?Object(De.jsx)("i",{className:"fa-solid fa-video-slash"}):Object(De.jsx)("i",{className:"fa-solid fa-video"})}),Object(De.jsx)("div",{className:"icon-control",children:Object(De.jsx)("img",{src:Le+"call.png",alt:"",className:"call-icon",onClick:function(){var e=R.id;(null===R||void 0===R?void 0:R.getTracks()).forEach((function(e){return e.stop()})),P({type:be}),null===F||void 0===F||F.emit("end-call",{userOutCallId:null===D||void 0===D?void 0:D._id,streamId:e})}})}),Object(De.jsx)("div",{className:"icon-mic icon-control",onClick:function(){U("audio"),x((function(e){return!e}))},children:h?Object(De.jsx)("img",{src:Le+"mic.png",alt:""}):Object(De.jsx)("i",{className:"fa-solid fa-microphone-slash"})}),Object(De.jsx)("div",{className:"icon-control",children:Object(De.jsx)("img",{src:Le+"cast.png",alt:""})})]})]}),Object(De.jsxs)("div",{className:"content_right",children:[Object(De.jsxs)("div",{className:"joined",children:[Object(De.jsx)("p",{children:"People Joined"}),Object(De.jsx)("div",{className:"video-joins"})]}),Object(De.jsx)(Ot,{})]})]})]})]})]})};n(643);qe.a.defaults.baseURL="http://localhost:8080/v1/api";var It=function(e,t){return function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(c){var r,a,s,i,o,l,b,f,v;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c({type:d}),n.prev=1,n.next=4,qe.a.post("/auth/login",e);case 4:r=n.sent,a=r.data,s=a.user,i=a.message,o=a.accessToken,l=a.refreshToken,Re.b.success(i,{autoClose:500}),c({type:u,payload:s}),localStorage.setItem(Ve,JSON.stringify(o)),localStorage.setItem(Qe,JSON.stringify(l)),t("/"),n.next=18;break;case 13:n.prev=13,n.t0=n.catch(1),v=n.t0.message||(null===n.t0||void 0===n.t0||null===(b=n.t0.response)||void 0===b||null===(f=b.data)||void 0===f?void 0:f.message),Re.b.error(v,{autoClose:2e3}),c({type:j,payload:n.t0});case 18:case"end":return n.stop()}}),n,null,[[1,13]])})));return function(e){return n.apply(this,arguments)}}()},wt=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t,n){var c,r,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,qe.a.post("/auth/register",t);case 3:e.sent,n("/login"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),a=e.t0.message||(null===e.t0||void 0===e.t0||null===(c=e.t0.response)||void 0===c||null===(r=c.data)||void 0===r?void 0:r.message),Re.b.error(a,{autoClose:2e3});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),At=n(710);var Et=n(15),St=(n(644),n(645),n(714)),Rt=n(715),Tt=function(e,t){for(var n=arguments.length,c=new Array(n>2?n-2:0),r=2;r<n;r++)c[r-2]=arguments[r];var a;return t||(t=1e3),function(){a&&(clearTimeout(a),a=null),a=setTimeout((function(){e.apply(void 0,c)}),t)}},Ft=(n(646),function(e){var t=e.friendRequest,n=e.user,r=Object(Ie.c)((function(e){return e.friendRequest})).type,a=Object(Ie.c)((function(e){return e.network})).socket,s=Object(Ie.c)((function(e){return e.auth})).userCurrent,i=Object(c.useMemo)((function(){return t.status}),[t]),o=Object(Ie.b)(),l=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=14;break}return e.next=4,ze("/friend-request/accept-friend-request",{friendId:null===n||void 0===n?void 0:n._id,friendRequestId:null===t||void 0===t?void 0:t._id});case 4:return c=e.sent,r=c.message,Re.b.success(r,{autoClose:1e3}),o({type:_,payload:null===t||void 0===t?void 0:t._id}),e.next=10,Xe("/notification",{link:"",userId:null===n||void 0===n?void 0:n._id,text:(null===s||void 0===s?void 0:s.userName)+" has accepted your friend request"});case 10:a=e.sent,a.notification,e.next=15;break;case 14:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.log("err",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=10;break}return e.next=4,ze("/friend-request/refuse-request",{friendRequestId:null===t||void 0===t?void 0:t._id});case 4:n=e.sent,o({type:_,payload:null===t||void 0===t?void 0:t._id}),c=n.message,Re.b.success(c,{autoClose:1e3}),e.next=11;break;case 10:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=10;break}return e.next=4,et("/friend-request/".concat(null===t||void 0===t?void 0:t._id));case 4:n=e.sent,o({type:_,payload:null===t||void 0===t?void 0:t._id}),c=n.message,Re.b.success(c,{autoClose:1e3}),e.next=11;break;case 10:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r,i,l;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=15;break}return e.next=4,ze("/friend-request",{friendRequestId:null===t||void 0===t?void 0:t._id,status:1});case 4:return c=e.sent,o({type:_,payload:null===t||void 0===t?void 0:t._id}),r=c.message,Re.b.success(r,{autoClose:1e3}),e.next=10,Xe("/notification",{link:"",userId:null===n||void 0===n?void 0:n._id,text:(null===s||void 0===s?void 0:s.userName)+" sent a friend request"});case 10:i=e.sent,l=i.notification,null===a||void 0===a||a.emit("createNotification",{notification:l}),e.next=17;break;case 15:throw Re.b.error("An error occurred while making this request!!!",{autoClose:1e3}),new Error("Friend Request not Exit");case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log("err",e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsx)("div",{className:"button-actions",children:"received"===r?Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("button",{type:"button",className:"btn btn-primary",onClick:l,children:"Accept"}),Object(De.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:u,children:"Refusse"})]}):Object(De.jsx)(De.Fragment,{children:1===i?Object(De.jsx)(De.Fragment,{children:Object(De.jsx)("button",{type:"button",className:"btn btn-warning",onClick:d,children:"Cancel invitation"})}):Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("button",{type:"button",className:"btn btn-light",onClick:j,children:"Send to"}),Object(De.jsx)("button",{type:"button",className:"btn btn-danger",onClick:d,children:"Remove"})]})})})}),Lt=function(e){var t=e.friendRequest,n=Object(c.useState)(),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(Ie.c)((function(e){return e.friendRequest})).type;return Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r,a;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,c="received"===i?null===t||void 0===t?void 0:t.senderId:null===t||void 0===t?void 0:t.receiverId){n.next=5;break}throw Re.b.error("id user not found",{autoClose:1e3}),new Error("id user not found");case 5:return n.next=7,Ze("/user?userId=".concat(c));case 7:r=n.sent,r.message,a=r.user,e&&s(a),n.next=15;break;case 12:n.prev=12,n.t0=n.catch(0),console.log("err",n.t0);case 15:case"end":return n.stop()}}),n,null,[[0,12]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[]),Object(De.jsx)(De.Fragment,{children:a&&Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:"info",children:[Object(De.jsx)(dt,{height:"60px",width:"60px",user:a}),Object(De.jsx)("span",{children:null===a||void 0===a?void 0:a.userName})]}),Object(De.jsx)(Ft,{user:a,friendRequest:t})]})})},Dt=function(){var e=Object(Ie.c)((function(e){return e.friendRequest})),t=e.type,n=e.listFriendRequest,r=Object(Ie.b)();return Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,a;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=12;break}return n.prev=1,n.next=4,Ze("/friend-request/get-all-requests-".concat(t));case 4:c=n.sent,c.message,a=c.friendRequests,e&&r({type:N,payload:a}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(1),console.log("err",n.t0);case 12:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t]),Object(De.jsx)(De.Fragment,{children:n&&n.map((function(e){return Object(De.jsx)("div",{className:"friendRequest",children:Object(De.jsx)(Lt,{friendRequest:e})},null===e||void 0===e?void 0:e._id)}))})},Pt=function(){var e=Object(Ie.b)();return Object(De.jsxs)("div",{className:"boxFriendRequest nav-item dropdown",children:[Object(De.jsx)("h3",{className:"title",children:"Options"}),Object(De.jsxs)("div",{className:"button-options",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){return e({type:g,payload:"received"})},children:"Friend request received"}),Object(De.jsx)("button",{type:"button",className:"btn btn-dark",onClick:function(){return e({type:g,payload:"sent"})},children:"Friend request sent"})]}),Object(De.jsx)(Dt,{}),Object(De.jsx)("div",{className:"friendRequest"})]})},Ut=n(712);n(647);function Mt(e){var t=e.conversation,n=t._id,r=t.reads,a=t.members,s=t.isMultiple,i=t.name,o=t.image,l=t.listMembers,u=t.images,d=t.nameConversation,j=Object(c.useState)(""),b=Object(Se.a)(j,2),f=b[0],v=b[1],O=Object(c.useState)(!0),m=Object(Se.a)(O,2),p=m[0],h=m[1],x=Object(c.useState)((function(){return t.lastMessage||""})),g=Object(Se.a)(x,2),N=g[0],y=g[1],_=Object(Ie.c)((function(e){return e.auth})).userCurrent,C=Object(Ie.c)((function(e){return e.chat})),k=C.lastMessageConversation,I=(C.statusConversations,Object(Ie.b)());Object(c.useEffect)((function(){var e=!0;if(t){var n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r,s;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=a.filter((function(e){return e!==(null===_||void 0===_?void 0:_._id)})),n.next=3,Promise.all(c.map((function(e){return Ze("/user?userId=".concat(e))})));case 3:r=n.sent,s=r.map((function(e){return e.user})),e&&I({type:xe,payload:{conversationId:null===t||void 0===t?void 0:t._id,listMembers:s}});case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return l||n(),function(){return e=!1}}}),[t,l]),Object(c.useEffect)((function(){var e=!0;if(t&&_){var n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s&&o.length&&e&&I({type:xe,payload:{conversationId:null===t||void 0===t?void 0:t._id,images:[{src:o[0],key:Object(mt.a)()}]}});case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return u||n(),function(){return e=!1}}}),[t,_,u]),Object(c.useEffect)((function(){if(t&&_&&!d)if(s)I({type:xe,payload:{conversationId:null===t||void 0===t?void 0:t._id,nameConversation:i}});else{if(!l)return;var e=l[0].userName;I({type:xe,payload:{conversationId:null===t||void 0===t?void 0:t._id,nameConversation:e}})}}),[t,_,d,l,i]),Object(c.useEffect)((function(){r&&_&&h((function(){return r.includes(_._id)}))}),[r,_]),Object(c.useEffect)((function(){k&&(null===k||void 0===k?void 0:k.conversationId)===n&&y(k)}),[k]),Object(c.useEffect)((function(){if(l&&_&&!(u&&u.length>0)){var e=[];if(s){for(var n=[],c=a.length,r=0;r<2;++r){var i=void 0;do{var o=Math.floor(Math.random()*c);n.includes(a[o])||(n.push(a[o]),i=!0)}while(!i)}e=n.map((function(e){var t;return{src:(t=e===(null===_||void 0===_?void 0:_._id)?_.profilePicture:l.find((function(t){return(null===t||void 0===t?void 0:t._id)===e})).profilePicture)&&t.length?t[0]:Te,key:Object(mt.a)()}}))}else{var d=l[0].profilePicture;e.push({src:d.length?d[0]:Te,key:Object(mt.a)()})}I({type:xe,payload:{conversationId:null===t||void 0===t?void 0:t._id,images:e}})}}),[l,a,u,_]),Object(c.useEffect)((function(){if(N&&l&&_){N.isNotify;var e,t=N.senderId,n=(N.notify,N.text);if(t===(null===_||void 0===_?void 0:_._id))e="You";else{var c=l.find((function(e){return(null===e||void 0===e?void 0:e._id)===t}));e=w(null===c||void 0===c?void 0:c.userName)}v(e+": "+n)}}),[N,l]);var w=function(e){var t=e.split(" "),n=t.length;return t&&n?t[n-1]:(null===e||void 0===e?void 0:e.userName)||""};return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("div",{className:"pic banner",children:u&&(1===u.length?Object(De.jsx)("img",{className:"one-img",src:u[0].src,alt:""}):Object(De.jsx)("div",{className:"multiple-img",children:u.map((function(e){return Object(De.jsx)("img",{src:e.src},e.key)}))}))}),Object(De.jsx)("div",{className:"name ".concat(p?"":"unread"),children:d}),Object(De.jsx)("div",{className:"message ".concat(p?"":"unread"),children:"notify"===(null===N||void 0===N?void 0:N[0])?null===N||void 0===N?void 0:N[1]:f}),!p&&Object(De.jsx)("div",{className:"NotificationCircle"})]})}var qt=function(){return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)("div",{className:"message stark",children:[Object(De.jsx)("div",{className:"typing typing-1"}),Object(De.jsx)("div",{className:"typing typing-2"}),Object(De.jsx)("div",{className:"typing typing-3"})]})})},Bt=n(181),Vt=n.n(Bt),Qt=function(e){var t=e.message,n=Object(c.useState)(),r=Object(Se.a)(n,2),a=(r[0],r[1]),s=Object(Ie.c)((function(e){return e.chat})).conversationChat.listMembers,i=Object(Ie.c)((function(e){return e.auth})).userCurrent;return Object(c.useEffect)((function(){var e;t&&s&&(e=t.senderId===(null===i||void 0===i?void 0:i._id)?Object(we.a)({},i):s.find((function(e){return(null===e||void 0===e?void 0:e._id)===t.senderId})),a({profilePicture:e.profilePicture,userName:e.userName}))}),[t,s,i]),Object(De.jsx)(De.Fragment,{children:null!==t&&void 0!==t&&t.isNotify?null!==t&&void 0!==t&&t.senderId?Object(De.jsx)("div",{className:"message ".concat(t.senderId===(null===i||void 0===i?void 0:i._id)?"user":"friend"),children:t.senderId===(null===i||void 0===i?void 0:i._id)?null===t||void 0===t?void 0:t.notify[0]:null===t||void 0===t?void 0:t.notify[1]}):Object(De.jsx)("div",{className:"message notify",children:t.notify[0]}):(null===t||void 0===t?void 0:t.text)&&Object(De.jsx)("div",{className:"message ".concat(t.senderId===(null===i||void 0===i?void 0:i._id)?"user":"friend"),children:t.text})})},Jt=function(e){var t=e.updateConversation,n=e.messages,r=e.setMessages,a=Object(Ie.c)((function(e){return e.auth})).userCurrent,s=Object(Ie.c)((function(e){return e.chat})).conversationChat,i=Object(Ie.c)((function(e){return e.network})).socket,o=Object(Ie.b)(),l=Object(c.useRef)();Object(c.useEffect)((function(){l.current&&l.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}),[n]);var u=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(c){var l,u,d,j;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=n[n.length-1],e.prev=1,e.next=4,et("/message/".concat(null===c||void 0===c?void 0:c._id));case 4:u=e.sent,d=null,(null===l||void 0===l?void 0:l._id)===(null===c||void 0===c?void 0:c._id)&&(d={conversationId:c.conversationId,senderId:null===a||void 0===a?void 0:a._id,message:" has withdrawn the message"},t({conversationId:null===c||void 0===c?void 0:c.conversationId,lastMessage:[null===a||void 0===a?void 0:a._id," has withdrawn the message"]}),o({type:E,payload:d})),j=u.newMessage,r((function(e){return e.map((function(e){return e._id==(null===j||void 0===j?void 0:j._id)?j:e}))})),i.emit("removeMessage",{newMessage:j,receverId:s.members.find((function(e){return e!==(null===a||void 0===a?void 0:a._id)})),lastMessage:d}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.log("err",e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(De.jsx)(De.Fragment,{children:n.map((function(e){return Object(De.jsxs)("div",{className:"messageContent",ref:l,children:[Object(De.jsx)(Qt,{message:e}),!(null!==e&&void 0!==e&&e.notify)&&Object(De.jsx)("div",{className:"imgsContainer ".concat(!(null!==e&&void 0!==e&&e.text)&&"add-space"," ").concat(e.senderId===(null===a||void 0===a?void 0:a._id)?"user":"friend"),children:Object(De.jsx)("div",{className:"imgs ",children:e.images.map((function(e){return Object(De.jsx)("div",{className:"img",children:Object(De.jsx)("img",{src:e.url})},e.public_id)}))})}),Object(De.jsx)("div",{className:"time ".concat((null===e||void 0===e?void 0:e.notify)?"notify":e.senderId===(null===a||void 0===a?void 0:a._id)&&"user"),children:Vt()(null===e||void 0===e?void 0:e.createdAt).format("HH:mm")}),!e.isDeleted&&e.senderId===(null===a||void 0===a?void 0:a._id)&&Object(De.jsxs)("span",{className:"CrudMessage",children:[Object(De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAFBJREFUSEtjZKAxYKSx+Qwjy4L/aMFJlO+JUgQ1eNQC2iRYUuKALBeQYsFoJBMMYpoHEUEXYFNASiTT3AKaB9GoBWTFIUFNgyoVEXTtgOQDAEM9DBleh0KcAAAAAElFTkSuQmCC"}),Object(De.jsx)("div",{className:"buttonActions",children:Object(De.jsx)("button",{type:"button",onClick:function(){return u(e)},children:"Remove"})})]})]},null===e||void 0===e?void 0:e._id)}))})},Yt=n(711),Ht=function(){var e=Object(Ie.c)((function(e){return e.message})).files,t=Object(Ie.b)();return Object(De.jsx)("div",{className:"display-image-message",style:{padding:"".concat(e.length&&"10px")},children:e.map((function(e){return Object(De.jsxs)("div",{className:"imgMessage",children:[Object(De.jsx)("img",{src:URL.createObjectURL(e)}),Object(De.jsx)("span",{className:"imgCancel",onClick:function(){return t({type:A,payload:e.uuid})},children:Object(De.jsx)(Yt.a,{})})]},e.uuid)}))})},Kt=function(e){var t=e.createNewMessage,n=Object(c.useState)(!1),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(c.useRef)(),o=Object(Ie.c)((function(e){return e.message})).files,l=Object(Ie.c)((function(e){return e.chat})).conversationChat,u=Object(Ie.c)((function(e){return e.network})).socket,d=Object(Ie.b)();Object(c.useEffect)((function(){var e;a&&(null===u||void 0===u||u.emit("typing",{receiverId:null===l||void 0===l||null===(e=l.friend)||void 0===e?void 0:e._id,conversationId:null===l||void 0===l?void 0:l._id}))}),[a]);var j=function(){t(i.current.value),i.current.value="",i.current.focus()};return Object(De.jsxs)("form",{className:"input ".concat(!l&&"disable"," ").concat(o.length&&"files"),onSubmit:function(e){e.preventDefault(),j()},children:[Object(De.jsx)("label",{htmlFor:null===l||void 0===l?void 0:l._id,className:"icon-camera",children:Object(De.jsx)("i",{className:"fas fa-camera"})}),Object(De.jsx)("input",{style:{display:" none"},type:"file",id:null===l||void 0===l?void 0:l._id,accept:".png,.jpeg,.jpg",multiple:!0,onChange:function(e){var t=Array.from(e.target.files);d({type:I,payload:[].concat(Object(Ue.a)(t.map((function(e){return e.uuid=Object(mt.a)(),e}))),Object(Ue.a)(o))})}}),Object(De.jsx)("i",{className:"far fa-laugh-beam"}),Object(De.jsxs)("div",{className:"inputContainer",children:[Object(De.jsx)(Ht,{}),Object(De.jsxs)("div",{className:"inputCreate",children:[Object(De.jsx)("input",{ref:i,placeholder:"Aa",type:"text",onChange:function(){return s(!0)},onBlur:function(){return s(!1)}}),Object(De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAARpJREFUSEu9lIERwUAQRX8qoBNUQgeUoAQqQAd0QAdUgA7ogA7MyyyTObncJhE7kzFD/Hd/999m6riyjvX1d8BFUk/SQtLuF+5CBw8DoH2TtJW0kcT3jSoE7CWNAyXE101BIWAuaRU5KiAOsDR3LkchYCjp7PgnrXOBylJUnEOKhSNmdIy9WAbAxcweEuUpADj6AqXuwcRA4eBjUGJOID4RTwHeQv2Cq4HDEqAR79UBTA1CC1N1lZS/lwLQIoT59BTCtIiU5RUb8vu0tMZTJ1svriHXienBTuyOqfeikRIWIvuqsuqsiqetCpdwbAZlyw5hBsdTe6tWreu7paGRcMwBF4Tk0IZP1FJ9rvo9dQ/aaEfvQWvRokDnDl64CTgZWvgaSwAAAABJRU5ErkJggg==",onClick:j})]})]}),Object(De.jsx)("i",{className:"fas fa-microphone"})]})},Gt=function(){var e=Object(Ie.b)(),t=Object(Ie.c)((function(e){return e.chat})).friendChat,n=Object(Ie.c)((function(e){return e.chat})).conversationChat._id,r=Object(Ie.c)((function(e){return e.network})).socket,a=Object(Ie.c)((function(e){return e.peer})),s=Object(Ie.c)((function(e){return e.auth})).userCurrent,i=Object(Ie.c)((function(e){return e.call})),o=i.userStream,l=i.isCall,u=i.isVideo,d=i.userReciverCall,j=i.roomCallId,b=i.isAnswer,f=i.conversationId,v=function(){var c=Object(Ee.a)(Object(Ae.a)().mark((function c(i){var o,l,u,d,j,b;return Object(Ae.a)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Ze("/room-chat?conversationId=".concat(n));case 3:return o=c.sent,l=o.roomCall,c.next=7,xt(i);case 7:if(u=c.sent,e({type:pe,payload:u}),!l){c.next=18;break}if(d=l.conversationId,j=l.isVideo,b=l.roomCallId,e({type:je,payload:{isVideo:j,isAnswer:!0,isCall:!0,isCreate:!1,conversationId:d}}),Nt(u,!0),r){c.next=15;break}return c.abrupt("return");case 15:r.emit("joinRoomCall",{roomCallId:b,peerId:a._id,isCreate:!1,conversationId:d,isVideo:j,isNext:!0,userJoinCallId:null===s||void 0===s?void 0:s._id,userName:null===s||void 0===s?void 0:s.userName,streamId:u.id}),c.next=19;break;case 18:e({type:je,payload:{isVideo:i,userSenderCall:null,userReciverCall:t,isSenderCall:!0,roomCallId:Object(mt.a)(),isCall:!0,isCreate:!0,conversationId:n}});case 19:c.next=24;break;case 21:c.prev=21,c.t0=c.catch(0),console.log("err",{err:c.t0});case 24:case"end":return c.stop()}}),c,null,[[0,21]])})));return function(e){return c.apply(this,arguments)}}();return Object(c.useEffect)((function(){r&&s&&l&&o&&(b||null===r||void 0===r||r.emit("createCall",{isVideo:u,sender:{profilePicture:s.profilePicture,userName:s.userName,_id:null===s||void 0===s?void 0:s._id},conversationId:f,receiverId:null===d||void 0===d?void 0:d._id,roomCallId:j,isCreate:!0,streamId:o.id}))}),[r,s,l,o,b]),Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)("div",{className:"icon-call",children:[Object(De.jsx)("i",{className:"fa-solid fa-phone",onClick:function(){return v(!1)}}),Object(De.jsx)("i",{className:"fa-solid fa-video",onClick:function(){return v(!0)}})]})})},Wt=function(e,t){return e.includes(t)},Zt=function(e,t,n){return n&&n(e,t)||Wt(e,t)?e:[].concat(Object(Ue.a)(e),[t])},Xt=function(){var e=Object(c.useState)([]),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(!1),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(Ie.c)((function(e){return e.chat})).conversationChat,u=Object(Ie.c)((function(e){return e.network})).socket,d=Object(Ie.c)((function(e){return e.auth})).userCurrent,j=Object(Ie.c)((function(e){return e.message})).files,b=Object(Ie.b)();Object(c.useEffect)((function(){var e=!0;if(u){var t=function(t){(null===l||void 0===l?void 0:l._id)===t&&e&&o(!0)},n=function(e){var t=e.newMessage,n=e.lastMessage;n&&b({type:E,payload:n}),(null===t||void 0===t?void 0:t.conversationId)===(null===l||void 0===l?void 0:l._id)&&r((function(e){return e.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)?t:e}))}))},c=function(e){e.userDisconnectId,e.time};return u.on("displayTyping",t),u.on("updateMessage",n),u.on("friendLogout",c),function(){e=!1,null===u||void 0===u||u.off("displayTyping",t),null===u||void 0===u||u.off("updateMessage",n),null===u||void 0===u||u.off("friendLogout",c)}}}),[u]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===l||void 0===l||!l._id){t.next=12;break}return t.prev=1,t.next=4,Ze("/message/".concat(l._id));case 4:n=t.sent,n.message,c=n.messages,e&&r(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return l&&t(),function(){return e=!1}}),[l]),Object(c.useEffect)((function(){var e=function(e){var t=e.newMessage,n=e.receiverId,c=t.conversationId;t.text,t.senderId;b({type:E,payload:t}),l&&c===l._id&&(f({receiverId:n,conversationId:c,isRead:!0}),console.log("nhan duoc tin nhan"),r((function(e){return Zt(e,t,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))}))}),!1),o(!1))};return null===u||void 0===u||u.on("getMessage",e),function(){null===u||void 0===u||u.off("getMessage",e)}}),[u,l]);var f=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xe("/conversation/update-conversation",t);case 3:n=e.sent,n.message,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("err",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n,c,a,s;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t||j.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n={conversationId:null===l||void 0===l?void 0:l._id,senderId:null===d||void 0===d?void 0:d._id},t&&(n.text=t),e.next=7,ot(j);case 7:return c=e.sent,n.images=Object(Ue.a)(c),e.next=11,Xe("/message",n);case 11:a=e.sent,a.message,s=a.newMessage,f({conversationId:null===l||void 0===l?void 0:l._id,reads:[null===d||void 0===d?void 0:d._id]}),b({type:E,payload:s}),b({type:I,payload:[]}),null===u||void 0===u||u.emit("sendMessage",{receivers:l.members,newMessage:s}),r((function(e){return[].concat(Object(Ue.a)(e),[s])})),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(2),console.log("err",e.t0);case 23:case"end":return e.stop()}}),e,null,[[2,20]])})));return function(t){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("div",{className:"contact bar",children:l&&Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("div",{className:"pic",children:l.images&&(1===l.images.length?Object(De.jsx)("img",{className:"one-img",src:l.images[0].src,alt:""}):Object(De.jsx)("div",{className:"multiple-img",children:l.images.map((function(e){return Object(De.jsx)("img",{src:e.src},e.key)}))}))}),Object(De.jsx)("div",{className:"contact-info",children:Object(De.jsx)("div",{className:"name",children:l.nameConversation})}),Object(De.jsx)(Gt,{})]})}),Object(De.jsx)("div",{className:"messages",id:"chat",children:l?Object(De.jsxs)("div",{className:"messagesContainer",children:[Object(De.jsx)(Jt,{updateConversation:f,setMessages:r,messages:n}),i&&Object(De.jsx)(qt,{})]}):Object(De.jsx)("div",{className:"noMes",children:"Chon ban de chat"})}),Object(De.jsx)(Kt,{createNewMessage:v})]})},zt=(n(648),function(){var e=Object(c.useState)(0),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(Ie.c)((function(e){return e.chat})).listConversation,s=Object(Ie.c)((function(e){return e.auth})).userCurrent,i=Object(Ie.b)();Object(c.useEffect)((function(){if(a&&s){var e=s._id,t=a.reduce((function(t,n){return n.status.includes(e)?t:t+1}),0);r(t)}}),[a,s]);return Object(De.jsxs)("h2",{className:"options-message",onClick:function(){i({type:D,payload:!0})},children:[Object(De.jsxs)("div",{className:"number",children:[Object(De.jsx)("i",{className:"fa-solid fa-message"}),Object(De.jsx)("span",{children:n})]}),"Message waiting"]})}),$t=(n(649),function(){var e=Object(c.useState)(),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(c.useRef)(""),s=Object(c.useRef)(""),i=Object(Ie.c)((function(e){return e.auth})).userCurrent,o=Object(Ie.c)((function(e){return e.createRoomChat})),l=o.friends,u=o.friendAdds,d=Object(Ie.b)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!i||!i._id){t.next=12;break}return t.prev=1,t.next=4,Ze("/user/get-friends/".concat(null===i||void 0===i?void 0:i._id));case 4:n=t.sent,n.message,c=n.friends,e&&d({type:Ce,payload:c}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[i]);var j=function(){return d({type:ke})},b=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c,r,o,l;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t={},a.current.value){e.next=3;break}return e.abrupt("return",Re.b.info("Please enter name room chat",{autoClose:500}));case 3:if(u.length){e.next=5;break}return e.abrupt("return",Re.b.info("Please add members to room chat",{autoClose:500}));case 5:if(t.members=[null===i||void 0===i?void 0:i._id].concat(Object(Ue.a)(u.map((function(e){return null===e||void 0===e?void 0:e._id})))),!n){e.next=12;break}return e.next=9,ot([n]);case 9:for(r in c=e.sent,t.image=[],c[0])t.image.push(c[0][r]);case 12:return t.name=a.current.value,t.desc=s.current.value,t.reads=[null===i||void 0===i?void 0:i._id].concat(Object(Ue.a)(u.map((function(e){return null===e||void 0===e?void 0:e._id})))),t.status=[null===i||void 0===i?void 0:i._id],t.isMultiple=!0,e.next=19,Xe("/conversation",t);case 19:o=e.sent,l=o.conversation,d({type:M,payload:{conversation:l}}),j();case 23:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(De.jsx)("div",{className:"create_room_modal",children:Object(De.jsxs)("div",{className:"container",children:[Object(De.jsx)("h3",{className:"title",children:"Create New Room Chat"}),Object(De.jsxs)("div",{className:"content",children:[Object(De.jsxs)("div",{className:"content-left",children:[Object(De.jsx)("h4",{children:"Add friends to the room"}),Object(De.jsx)("div",{className:"list_friend",children:l.map((function(e){return Object(De.jsxs)("div",{className:"friend",children:[Object(De.jsxs)("div",{className:"friend-info",children:[Object(De.jsx)(dt,{user:e,link:!1,isStatus:!1}),Object(De.jsx)("p",{className:"friend-name",children:null===e||void 0===e?void 0:e.userName})]}),Object(De.jsx)("div",{className:"button-actions",children:Object(De.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){return d({type:ye,payload:e})},children:"Add"})})]},null===e||void 0===e?void 0:e._id)}))})]}),Object(De.jsxs)("div",{className:"content-right",children:[Object(De.jsx)("h4",{children:"Room information you want to create"}),Object(De.jsxs)("div",{className:"form-group",children:[Object(De.jsx)("label",{htmlFor:"name-room",children:"Name Room"}),Object(De.jsx)("input",{ref:a,type:"text",className:"form-control",id:"name-room",placeholder:"abc",required:!0})]}),Object(De.jsxs)("div",{className:"form-group",children:[Object(De.jsx)("label",{htmlFor:"desc-room",children:"Description"}),Object(De.jsx)("input",{ref:s,type:"text",className:"form-control",id:"desc-room",placeholder:"abc"})]}),Object(De.jsxs)("div",{className:"custom-file",children:[Object(De.jsx)("input",{onChange:function(e){return r(e.target.files[0])},type:"file",className:"custom-file-input",id:"validatedCustomFile"}),Object(De.jsx)("label",{className:"custom-file-label",htmlFor:"validatedCustomFile",children:"Choose Avatar..."})]}),Object(De.jsx)("div",{className:"display_room_avatar",children:n&&Object(De.jsx)("img",{src:URL.createObjectURL(n),alt:""})}),u.length>0&&Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("h5",{className:"members mt-4",children:"members"}),Object(De.jsx)("div",{className:"list_friend",children:u.map((function(e){return Object(De.jsxs)("div",{className:"friend",children:[Object(De.jsxs)("div",{className:"friend-info",children:[Object(De.jsx)(dt,{user:e,link:!1,isStatus:!1}),Object(De.jsx)("p",{className:"friend-name",children:null===e||void 0===e?void 0:e.userName})]}),Object(De.jsx)("div",{className:"button-actions",children:Object(De.jsx)("button",{type:"button",className:"btn btn-success",onClick:function(){return d({type:_e,payload:e})},children:"Delete"})})]},null===e||void 0===e?void 0:e._id)}))})]})]})]}),Object(De.jsxs)("div",{className:"footer",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-danger",onClick:j,children:"Cancel"}),Object(De.jsx)("button",{type:"button",className:"btn btn-info",onClick:b,children:"Save"})]})]})})});function en(){var e=Object(c.useState)([]),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(Ie.c)((function(e){return e.auth})).userCurrent,s=Object(Ie.c)((function(e){return e.createRoomChat})).isCreate,i=Object(Ie.c)((function(e){return e.chat})),o=i.conversationChat,l=i.listConversation,u=i.isShowConversationPending,d=Object(Ie.b)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.prev=1,t.next=4,Ze("/conversation/get-all-conversations");case 4:n=t.sent,n.message,c=(c=n.conversations).map((function(e){return e.roomCallId?Object(we.a)(Object(we.a)({},e),{},{lastMessage:["notify","Conversation going on"]}):e})),e&&d({type:F,payload:{userId:null===a||void 0===a?void 0:a._id,conversations:c}}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),console.log("err",t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[a]),Object(c.useEffect)((function(){if(l&&a){var e,t=a._id;e=u?l.filter((function(e){return!e.status.includes(t)})):l.filter((function(e){return e.status.includes(t)})),r(e)}}),[l,u,a]);var j=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t){var n,c,r,s,i;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o&&(null===t||void 0===t?void 0:t._id)===o._id){e.next=12;break}if(n=a._id,c=t.status,r=t.reads,s={},i=!1,c.includes(n)||(i=!0,s.status=[].concat(Object(Ue.a)(c),[n])),r.includes(n)||(s.reads=[].concat(Object(Ue.a)(r),[n])),!Object.entries(s).length){e.next=11;break}return e.next=10,Xe("/conversation/update-conversation",Object(we.a)({conversationId:null===t||void 0===t?void 0:t._id},s));case 10:e.sent;case 11:d({type:L,payload:{conversationChat:Object(we.a)(Object(we.a)({},t),s),isChangeType:i}});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:"center",children:[Object(De.jsxs)("div",{className:"contacts",children:[Object(De.jsxs)("div",{className:"options-chat",children:[Object(De.jsx)("i",{className:"fas fa-bars fa-2x"}),Object(De.jsx)("div",{className:"list_options_chat",children:Object(De.jsx)("button",{onClick:function(){d({type:Ne,payload:!0})},children:"Create chat room"})})]}),Object(De.jsx)(zt,{}),Object(De.jsx)("div",{className:"contacts-container",children:n&&n.map((function(e){return Object(De.jsx)("div",{className:"contact",onClick:function(){j(e)},children:Object(De.jsx)(Mt,{conversation:e})},null===e||void 0===e?void 0:e._id)}))})]}),Object(De.jsx)("div",{className:"chat",children:Object(De.jsx)(Xt,{conversationChat:o})})]}),s&&Object(De.jsx)($t,{})]})}var tn=function(){var e=Object(c.useState)(0),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(Ie.c)((function(e){return e.chat})),s=a.isChat,i=a.conversationUnReads,o=Object(Ie.c)((function(e){return e.network})).socket,l=Object(Ie.c)((function(e){return e.chat})).conversationChat,u=Object(Ie.b)();Object(c.useEffect)((function(){i&&r(i.length)}),[i]),Object(c.useEffect)((function(){var e=function(e){var t=e.newMessage.conversationId;l&&(null===l||void 0===l?void 0:l._id)===t||i.includes(t)||u({type:B})};return null===o||void 0===o||o.on("getMessage",e),function(){null===o||void 0===o||o.off("getMessage",e)}}),[o,i,l]);return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(Ut.a,{onClick:function(){var e={isChat:!s};s&&(e.conversationChat=null),u({type:T,payload:e})}}),Object(De.jsx)("span",{className:"topbarIconBadge",children:n}),s&&Object(De.jsx)(en,{})]})},nn=n(713),cn=(n(650),function(e){var t=e.notification,n=(Object(Ie.c)((function(e){return e.auth})).userCurrent,Object(Ie.b)()),c=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,et("/notification/".concat(t._id));case 3:c=e.sent,r=c.message,Re.b.success(r,{autoClose:1e3}),n({type:ne,payload:null===t||void 0===t?void 0:t._id}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze("/notification/unRead/".concat(t._id));case 3:c=e.sent,r=c.message,a=c.newNotification,Re.b.success(r,{autoClose:1e3}),n({type:se,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze("/notification/".concat(t._id));case 3:c=e.sent,r=c.message,a=c.newNotification,Re.b.success(r,{autoClose:1e3}),n({type:se,payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)("div",{className:"notificationCrudAction",children:[Object(De.jsx)("button",{className:"".concat(t.isRead?"disable":""," "),onClick:a,children:"Mark"}),Object(De.jsx)("button",{onClick:r,className:"".concat(t.isRead?"":"disable"," "),children:"Unread"}),Object(De.jsx)("button",{onClick:c,children:"Remove"})]})})}),rn=function(e){var t,n=e.notification,r=Object(c.useState)(null),a=Object(Se.a)(r,2),s=a[0],o=a[1],l=Object(Ie.c)((function(e){return e.auth})).userCurrent,u=Object(i.m)(),d=Object(Ie.b)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var c,r;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==n&&void 0!==n&&n.senderId){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,Ze("/user?userId=".concat(null===n||void 0===n?void 0:n.senderId));case 5:c=t.sent,r=c.user,e&&o(r),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),console.log("err",t.t0);case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){e=!1}}),[n]);var j=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n&&(null===n||void 0===n||!n.isRead)&&l){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,ze("/notification/".concat(null===n||void 0===n?void 0:n._id));case 5:t=e.sent,t.message,c=t.notification,d({type:se,payload:c}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("div",{className:"circle"}),Object(De.jsx)("span",{className:"time",children:nt.a(null===n||void 0===n?void 0:n.createdAt)}),Object(De.jsxs)("p",{className:"".concat(null!==n&&void 0!==n&&n.isRead?"read":""),onClick:function(){j(),u(null===n||void 0===n?void 0:n.link)},children:[Object(De.jsx)("b",{children:null===s||void 0===s?void 0:s.userName}),null===n||void 0===n?void 0:n.text.slice((null===n||void 0===n?void 0:n.text.indexOf(null===s||void 0===s?void 0:s.userName))+(null===s||void 0===s||null===(t=s.userName)||void 0===t?void 0:t.length))]}),Object(De.jsx)(cn,{notification:n})]})},an=(n(651),function(){var e=Object(Ie.c)((function(e){return e.notification})),t=e.isShowMenu,n=e.listNotifycation,r=e.type,a=function(e){s({type:ce,payload:e})},s=Object(Ie.b)();Object(c.useEffect)((function(){var e,t=!0;if(n)return e="all"===r?n:"unread"===r?n.filter((function(e){return!e.isRead})):n.filter((function(e){return e.isRead})),t&&s({type:re,payload:e}),function(){return t=!1}}),[r]);var i=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,et("/notification/delete-all-notification");case 3:t=e.sent,n=t.message,s({type:ae}),Re.b.success(n,{autoClose:1e3}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),o=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ze("/notification/read-all-notification");case 3:t=e.sent,n=t.message,t.notifications,Re.b.success(n,{autoClose:1e3}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsx)("div",{className:"menu ".concat(t&&"active"),children:Object(De.jsxs)("ul",{children:[Object(De.jsxs)("li",{className:"hvr-underline-from-left",onClick:Tt(a,500,"all"),children:[Object(De.jsx)("span",{className:"fa-solid fa-border-all"}),"All"]}),Object(De.jsxs)("li",{className:"hvr-underline-from-left",onClick:Tt(a,500,"read"),children:[Object(De.jsx)("span",{className:"fa-solid fa-check-double"}),"Read"]}),Object(De.jsxs)("li",{className:"hvr-underline-from-left",onClick:Tt(a,500,"unread"),children:[Object(De.jsx)("span",{className:"fa-solid fa-rectangle-xmark"}),"Un Read"]}),Object(De.jsxs)("li",{className:"hvr-underline-from-left",onClick:Tt(i,500),children:[Object(De.jsx)("span",{className:"fa-solid fa-trash-can"}),"Remove all"]}),Object(De.jsxs)("li",{className:"hvr-underline-from-left",onClick:Tt(o,500),children:[Object(De.jsx)("span",{className:"fa-solid fa-marker"}),"Mark"]})]})})}),sn=function(){Object(Ie.c)((function(e){return e.auth})).userCurrent;var e=Object(Ie.c)((function(e){return e.notification})),t=e.type,n=(e.listNotifycation,e.notificationDisplays),r=e.isShowMenu,a=Object(Ie.c)((function(e){return e.network})).socket,s=Object(Ie.b)();return Object(c.useEffect)((function(){if(a){var e=function(e){var n=e.notification;"all"===t&&"read"===t&&s({type:ie,payload:n}),s({type:X,payload:n})};return a.on("updateNotification",e),function(){return null===a||void 0===a?void 0:a.off("updateNotification",e)}}}),[a]),Object(De.jsxs)("div",{className:"frame",children:[Object(De.jsxs)("div",{className:"panel ".concat(r&&"show-menu"),children:[Object(De.jsxs)("div",{className:"header flex",children:[Object(De.jsxs)("div",{className:"menu-icon",onClick:function(){return s({type:oe})},children:[Object(De.jsx)("div",{className:"dash-top ".concat(r&&"slide-top")}),Object(De.jsx)("div",{className:"dash-bottom"}),Object(De.jsx)("div",{className:"circle circle-1 ".concat(r&&"slide")})]}),Object(De.jsx)("span",{className:"title",children:"Notifications"})]}),Object(De.jsxs)("div",{className:"notifications clearfix",children:[Object(De.jsx)("div",{className:"line"}),n&&n.map((function(e,t){return Object(De.jsx)("div",{className:"notification",style:{animation:"here-am-i 0.5s ease-out ".concat(.4+.2*t,"s"),animationFillMode:"both"},children:Object(De.jsx)(rn,{notification:e},null===e||void 0===e?void 0:e._id)},null===e||void 0===e?void 0:e._id)}))]})]}),Object(De.jsx)(an,{})]})},on=(n(652),function(){var e=Object(Ie.c)((function(e){return e.notification})),t=e.number,n=e.isShow,r=Object(Ie.c)((function(e){return e.auth})).userCurrent,a=Object(Ie.c)((function(e){return e.network})).socket,s=Object(Ie.b)();Object(c.useEffect)((function(){if(a){var e=function(){n||s({type:$})};return a.on("updateNotification",e),function(){return null===a||void 0===a?void 0:a.off("updateNotification",e)}}}),[a,n]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var c,a,i;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r||!n){t.next=15;break}return t.prev=1,t.next=4,Ze("/notification");case 4:c=t.sent,c.message,a=c.notifications,i=[],a.forEach((function(e){!e.isRead&&i.push(e)})),a.forEach((function(e){e.isRead&&i.push(e)})),e&&s({type:Z,payload:i}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),console.log("err",t.t0);case 15:case"end":return t.stop()}}),t,null,[[1,12]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[r,n]),Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=12;break}return t.prev=1,t.next=4,Ze("/notification/get-number-notification-not-read");case 4:n=t.sent,n.message,c=n.number,e&&s({type:z,payload:c}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[r]);return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(nn.a,{className:"svg-notification",style:{cursor:"pointer"},onClick:function(){s({type:te,payload:!n})}}),Object(De.jsx)("span",{className:"topbarIconBadge",children:t}),Object(De.jsx)("div",{className:"my-btn-border-notification"}),Object(De.jsx)("div",{className:"my-btn-1"}),n&&Object(De.jsx)(sn,{})]})});function ln(){var e=Object(c.useState)([]),t=Object(Se.a)(e,2),n=(t[0],t[1]),r=Object(c.useState)(!1),a=Object(Se.a)(r,2),s=(a[0],a[1],Object(c.useState)(!1)),o=Object(Se.a)(s,2),l=(o[0],o[1]),u=Object(c.useState)(),d=Object(Se.a)(u,2),j=d[0],b=d[1],f=Object(c.useState)(!1),v=Object(Se.a)(f,2),O=v[0],m=v[1],p=Object(c.useState)(!1),h=Object(Se.a)(p,2),g=h[0],N=h[1],y=Object(Ie.c)((function(e){return e.network})).socket,_=Object(Ie.c)((function(e){return e.auth})).userCurrent,I=Object(Ie.c)((function(e){return e.chat})),w=(I.isChat,I.statusConversations,Object(Ie.c)((function(e){return e.friendRequest})).number),A=Object(c.useRef)(),E=Object(c.useRef)(),S=Object(Ie.b)(),T=Object(i.m)();Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ze("/friend-request/get-number");case 3:n=t.sent,n.message,c=n.number,e&&S({type:k,payload:c}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("err",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[]),Object(c.useEffect)((function(){var e=function(){S({type:C})};return y&&y.on("updateNotification",e),function(){return null===y||void 0===y?void 0:y.off("updateNotification",e)}}),[y]),Object(c.useEffect)((function(){var e=function(e){e.target!==E.current&&e.target!==A.current&&m(!1)};return document.body.addEventListener("click",e),function(){document.body.removeEventListener("click",e)}}),[null===E||void 0===E?void 0:E.current]),Object(c.useEffect)((function(){var e=!0,t=function(t){var c=t.notification;e&&(n((function(e){return[c].concat(Object(Ue.a)(e))})),l(!1))};return y&&y.on("updateNotification",t),function(){e=!1,null===y||void 0===y||y.off("updateNotification",t)}}),[y]),Object(c.useEffect)((function(){var e=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=12;break}return e.prev=1,e.next=4,Ze("/conversation/get-status-conversation");case 4:t=e.sent,t.message,n=t.conversations,S({type:R,payload:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return e(),function(){return!1}}),[_]);var F=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n,c,r;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==A&&void 0!==A&&null!==(t=A.current)&&void 0!==t&&t.value){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Ze("/user/search-user/".concat(A.current.value));case 5:n=e.sent,c=n.message,r=n.users,Re.b.success(c,{autoClose:1e3}),r.length&&(m(!0),b(r)),Re.b.success(c,{autoClose:1e3}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log("err",e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsxs)("div",{className:"topbarContainer",children:[Object(De.jsx)("div",{className:"topbarLeft",children:Object(De.jsx)(tt.b,{to:"/",style:{textDecoration:"none"},children:Object(De.jsx)("span",{className:"logo",children:"CoderNoob"})})}),Object(De.jsx)("div",{className:"topbarCenter",children:Object(De.jsxs)("div",{className:"searchbar",children:[Object(De.jsx)(St.a,{className:"searchIcon"}),Object(De.jsx)("input",{ref:A,placeholder:"Search for friend, post or video",className:"searchInput",onFocus:function(){O||m(!0)},onChange:Tt(F,2e3)}),j&&O&&Object(De.jsx)("div",{className:"displayUsersSearch",ref:E,children:j.map((function(e){return Object(De.jsxs)("div",{className:"userSearchContainer",onClick:function(){return T("/profile/".concat(null===e||void 0===e?void 0:e._id))},children:[Object(De.jsx)(dt,{user:e}),Object(De.jsx)("span",{children:null===e||void 0===e?void 0:e.userName})]},null===e||void 0===e?void 0:e._id)}))})]})}),Object(De.jsxs)("div",{className:"topbarRight",children:[Object(De.jsxs)("div",{className:"topbarLinks",children:[Object(De.jsx)("span",{className:"topbarLink",children:"Homepage"}),Object(De.jsx)("span",{className:"topbarLink",children:"Timeline"})]}),Object(De.jsxs)("div",{className:"topbarIcons",children:[Object(De.jsxs)("div",{className:"topbarIconItem",children:[Object(De.jsx)(Rt.a,{onClick:function(){return N((function(e){return!e}))}}),g&&Object(De.jsx)(Pt,{}),Object(De.jsx)("span",{className:"topbarIconBadge",children:w})]}),Object(De.jsx)("div",{className:"topbarIconItem",children:Object(De.jsx)(tn,{})}),Object(De.jsx)("div",{className:"topbarIconItem",children:Object(De.jsx)(on,{})})]}),Object(De.jsx)("div",{onClick:function(){S({type:x}),S({type:W}),S({type:ge,payload:null}),localStorage.setItem("refresh-token",""),localStorage.setItem("access-token",""),localStorage.setItem("userId",""),null===y||void 0===y||y.emit("userLogOut",null===_||void 0===_?void 0:_._id),T("/login")},className:"logout",children:Object(De.jsx)("i",{className:"fa-solid fa-right-from-bracket topbarImg"})})]})]})}n(653);var un=n(716),dn=n(717),jn=n(718),bn=n(719),fn=n(720),vn=n(721),On=n(722),mn=n(723);n(654);function pn(e){var t,n=e.user;return Object(De.jsx)(tt.b,{to:"/profile/"+(null===n||void 0===n?void 0:n._id),style:{textDecoration:"none",color:"#333"},children:Object(De.jsxs)("li",{className:"sidebarFriend",children:[Object(De.jsx)("img",{className:"sidebarFriendImg",src:(null===n||void 0===n||null===(t=n.profilePicture)||void 0===t?void 0:t.length)&&(null===n||void 0===n?void 0:n.profilePicture[0])||Te,alt:""}),Object(De.jsx)("span",{className:"sidebarFriendName",children:n.userName})]})})}function hn(){var e=Object(c.useState)([]),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(Ie.c)((function(e){return e.auth})).userCurrent,s=Object(Ie.b)();return Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===a||void 0===a||!a._id){t.next=12;break}return t.prev=1,t.next=4,Ze("/user/get-users-suggestion/".concat(null===a||void 0===a?void 0:a._id));case 4:n=t.sent,n.message,c=n.users,e&&r(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[a]),Object(De.jsx)("div",{className:"sidebar",children:Object(De.jsxs)("div",{className:"sidebarWrapper",children:[Object(De.jsxs)("ul",{className:"sidebarList",children:[Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(un.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Feed"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(Ut.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",onClick:function(){return s({type:T,payload:!0})},children:"Chats"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(dn.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Videos"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(jn.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Groups"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(bn.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Bookmarks"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(fn.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Questions"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(vn.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Jobs"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(On.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Events"})]}),Object(De.jsxs)("li",{className:"sidebarListItem",children:[Object(De.jsx)(mn.a,{className:"sidebarIcon"}),Object(De.jsx)("span",{className:"sidebarListItemText",children:"Courses"})]})]}),Object(De.jsx)("button",{className:"sidebarButton",children:"Show More"}),Object(De.jsx)("hr",{className:"sidebarHr"}),Object(De.jsxs)("ul",{className:"sidebarUsersSuggestion",children:[Object(De.jsx)("h4",{className:"sidebarDesc",children:"Recommend friends"}),n.map((function(e){return Object(De.jsx)(pn,{user:e},null===e||void 0===e?void 0:e._id)}))]})]})})}n(655),n(656),n(657),n(658),n(659);var xn=function(e){var t=e.image,n=e.file,c=e.setImages,r=e.setFiles;return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("img",{src:t||(n.camera?n.url:URL.createObjectURL(n))}),Object(De.jsx)("span",{className:"imgCancel",onClick:function(){return t?c((function(e){return e.filter((function(e){return e.url!==t}))})):r((function(e){return e.filter((function(e){return e.uuid!==n.uuid}))}))},children:Object(De.jsx)(Yt.a,{})})]})},gn=n(724),Nn=function(e){var t=e.post,n=e.user,r=e.comment,a=e.isEdit,s=e.setIsEdit,i=e.setMessages,o=Object(c.useState)([]),l=Object(Se.a)(o,2),u=l[0],d=l[1],j=Object(c.useState)((null===r||void 0===r?void 0:r.text)||""),b=Object(Se.a)(j,2),f=b[0],v=b[1],O=Object(c.useState)([]),m=Object(Se.a)(O,2),p=m[0],h=m[1],x=Object(Ie.c)((function(e){return e.network})).socket,g=Object(Ie.c)((function(e){return e.auth})).userCurrent;Object(c.useEffect)((function(){d(null===r||void 0===r?void 0:r.images)}),[null===r||void 0===r?void 0:r.images]);var N=function(e){d(null===e||void 0===e?void 0:e.images),v((null===e||void 0===e?void 0:e.text)||""),h([]),s(!1)},y=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c,a,s,o,l;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=u?Object(Ue.a)(u):[],(c=null===r||void 0===r?void 0:r.images.filter((function(e){return!n.find((function(t){return e.url===t.url}))}))).length&&lt(c.map((function(e){return e.public_id}))),e.next=6,ot(p);case 6:return a=e.sent,n=[].concat(Object(Ue.a)(n),Object(Ue.a)(a)),e.next=10,ze("/comment/update-comment/".concat(null===r||void 0===r?void 0:r._id),{text:f,images:n,userId:null===g||void 0===g?void 0:g._id,isEdit:!0});case 10:s=e.sent,o=s.message,l=s.newComment,console.log("newComment",l),Re.b.success(o,{autoClose:2e3}),null===x||void 0===x||x.emit("commentPostHandler",{type:"update",comment:l,postId:null===t||void 0===t?void 0:t._id,userPost:t.userId,message:(null===g||void 0===g?void 0:g.userName)+"updated comment on your post"}),i((function(e){return e.map((function(e){return e._id===l._id?l:e}))})),N(l),e.next=22;break;case 19:e.prev=19,e.t0=e.catch(0),console.log("err",e.t0);case 22:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsx)("div",{className:"commentInfo ".concat(a&&"edit"),children:a?Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:"editCommentContainer",children:[Object(De.jsx)("input",{className:"editCommentInput",type:"text",autoFocus:!0,value:f,onChange:function(e){return v(e.target.value)}}),Object(De.jsx)("button",{onClick:function(){return N()},type:"button",className:"btn btn-secondary  btnEdit btnCancelEdit ",children:"Cancel"}),Object(De.jsx)("button",{type:"button",className:"btn btn-success btnEdit btnConfirmEdit",onClick:y,children:"Edit"})]}),Object(De.jsxs)("div",{className:"editImgPost",children:[Object(De.jsx)("div",{className:"editImgPostTop",children:Object(De.jsxs)("div",{className:"shareOption",children:[Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Posted photo"})]})}),Object(De.jsx)("div",{className:"disPlayImgCreateComment",children:u&&u.map((function(e){return Object(De.jsx)("div",{className:"imgContainer",children:Object(De.jsx)(xn,{image:e.url,setImages:d})},e.url)}))}),Object(De.jsxs)("div",{className:"editImgPostTop",children:[Object(De.jsxs)("label",{htmlFor:"editEomment"+r._id,className:"shareOption",children:[Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Add Photo or Video"})]}),Object(De.jsx)("input",{style:{display:" none"},type:"file",id:"editEomment"+r._id,accept:".png,.jpeg,.jpg",multiple:!0,onChange:function(e){var t=Array.from(e.target.files);h((function(e){return[].concat(Object(Ue.a)(e),Object(Ue.a)(t.map((function(e){return e.uuid=Object(mt.a)(),e}))))}))}})]}),Object(De.jsx)("div",{className:"disPlayImgCreateComment",children:p.map((function(e){return Object(De.jsx)("div",{className:"imgContainer",children:Object(De.jsx)(xn,{file:e,setFiles:h})},e.uuid)}))})]})]}):Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:"commentInfoTop",children:[Object(De.jsx)("span",{className:"commentUserName",children:null===n||void 0===n?void 0:n.userName}),Object(De.jsx)("span",{className:"commentText",children:null===r||void 0===r?void 0:r.text})]}),Object(De.jsx)("div",{className:"commentInfoImgContainer",children:r.images.map((function(e,t){return Object(De.jsx)("img",{className:"commentInfoImg",style:{width:"".concat(r.images.length%2!==0&&t===r.images.length-1?"100%":"calc(100%/2)")},src:e&&e.url},e.url)}))})]})})},yn=function(e){var t=e.id,n=e.setIsEdit;return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)("div",{className:"commentCrudAction",children:[Object(De.jsx)("button",{className:"updateComment",onClick:function(){return n((function(e){return!e}))},children:"Edit"}),Object(De.jsx)("button",{type:"button",className:"removeComment","data-toggle":"modal","data-target":"#"+t,children:"Remove"})]})})},_n=function(e){var t=e.id,n=e.onRemove,c=e.text;return Object(De.jsx)(De.Fragment,{children:Object(De.jsx)("div",{className:"modal fade",id:t,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(De.jsx)("div",{className:"modal-dialog",role:"document",children:Object(De.jsxs)("div",{className:"modal-content",children:[Object(De.jsxs)("div",{className:"modal-header",children:[Object(De.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"Confirm"}),Object(De.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",children:Object(De.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(De.jsx)("div",{className:"modal-body",children:"You confirm to permanently delete this "+c}),Object(De.jsxs)("div",{className:"modal-footer",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-danger",onClick:n,"data-dismiss":"modal",children:"Remove"}),Object(De.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",children:"Close"})]})]})})})})};var Cn=function(e){var t=e.comment,n=e.commentReply,r=e.setCommentsReply,a=Object(c.useState)(),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)({}),u=Object(Se.a)(l,2),d=(u[0],u[1]),j=Object(c.useState)(!1),b=Object(Se.a)(j,2),f=b[0],v=b[1],O=Object(c.useState)(!1),m=Object(Se.a)(O,2),p=m[0],h=m[1],x=Object(Ie.c)((function(e){return e.auth})).userCurrent,g=Object(c.useState)(!1),N=Object(Se.a)(g,2),y=N[0],_=N[1];Object(c.useEffect)((function(){o(null===n||void 0===n?void 0:n.likes.length),_(null===n||void 0===n?void 0:n.likes.includes(x._id))}),[null===n||void 0===n?void 0:n.likes,null===x||void 0===x?void 0:x._id]),Object(c.useEffect)((function(){var e=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ze("/user?userId=".concat(null===n||void 0===n?void 0:n.userId));case 3:t=e.sent,c=t.user,d(c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[n]),Object(c.useEffect)((function(){var e=function(e){f&&v(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[f]);var C=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!y){e.next=7;break}return e.next=4,ze("/comment/unlike-comment/".concat(n._id),{userId:x._id});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,ze("/comment/like-comment/".concat(n._id),{userId:x._id});case 9:e.t0=e.sent;case 10:t=e.t0,c=t.message,Re.b.success(c,{autoClose:1e3}),e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),console.log("err",e.t1);case 18:_(!y),o(y?i-1:i+1);case 20:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,et("/comment/remove-comment-reply/".concat(t._id,"/").concat(n._id,"/").concat(x._id));case 3:c=e.sent,a=c.message,Re.b.success(a,{autoClose:1e3}),r((function(e){return e.filter((function(e){return e._id!==n._id}))})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log("err",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)("div",{className:"commentReplyContainer",children:[Object(De.jsx)("div",{className:"commentReplyLeft",children:Object(De.jsx)(dt,{user:x})}),Object(De.jsxs)("div",{className:"commentReplyRight",children:[Object(De.jsxs)("div",{className:"commentReplyRightTop",children:[Object(De.jsx)(Nn,{user:x,comment:n,isEdit:p,setIsEdit:h,setMessages:r}),(null===n||void 0===n?void 0:n.userId)===x._id&&Object(De.jsxs)("div",{className:"commentCrud",onClick:function(){return v(!f)},children:[Object(De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAHVJREFUSEtjZKAxYKSx+QyjFhAM4dEgGqFB5MDAwDAf6vdEBgaGA1A2qeJgbdhS0QMGBgZ5qKEgtiISmxRxnBZ8YGBg4Ica+pCBgUEByiZVHKcFoKBYADU0AS2ISBHHaQHBpEeKgtGcTDC0RoNoNIgIhgBBBQBNkxgZxgF3rgAAAABJRU5ErkJggg=="}),f&&Object(De.jsx)(yn,{id:n._id,onRemoveComment:k,setIsEdit:h})]})]}),Object(De.jsxs)("div",{className:"commentReplyAction",children:[Object(De.jsxs)("div",{className:"commentReplyLikeContainer",children:[Object(De.jsx)("span",{className:"commentReplyLike ".concat(y&&"like"),onClick:C,children:"Like"}),Object(De.jsx)("span",{className:"commentReplyNumberLike",children:i})]}),Object(De.jsx)("span",{className:"commentRefDate",children:nt.a(null===n||void 0===n?void 0:n.createdAt)}),n.isEdit&&Object(De.jsx)("span",{className:"showIsEdit",children:"Edited"})]})]}),Object(De.jsx)(_n,{id:null===n||void 0===n?void 0:n._id,onRemove:k,text:"this comment ?"})]})})},kn=(n(660),function(e){var t=e.onCreateComment,n=e.user,r=e.setFiles,a=e.files,s=e.id,i=Object(c.useRef)();return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)("form",{className:"createComment",onSubmit:function(e){t(e,i.current.value),i.current.value=""},children:[Object(De.jsxs)("div",{className:"createCommentInput",children:[Object(De.jsx)(dt,{width:"50px",height:"50px",user:n}),Object(De.jsxs)("div",{className:"createCommentInputTop",children:[Object(De.jsx)("input",{autoFocus:!0,type:"text",ref:i,placeholder:"Enter comment..."}),Object(De.jsx)("label",{htmlFor:"filesCreateComment"+s,className:"shareOption",children:Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"})}),Object(De.jsx)("input",{style:{display:" none"},type:"file",id:"filesCreateComment"+s,accept:".png,.jpeg,.jpg",multiple:!0,onChange:function(e){var t=Array.from(e.target.files);r(Object(Ue.a)(t.map((function(e){return e.uuid=Object(mt.a)(),e}))))}})]}),Object(De.jsx)("button",{type:"submit",className:"btn btn-primary btnCreateComment",children:"Send"})]}),Object(De.jsx)("div",{className:"disPlayImgCreateComment",children:a.map((function(e){return Object(De.jsx)("div",{className:"imgContainer",children:Object(De.jsx)(xn,{file:e,setFiles:r})},e.uuid)}))})]})})});var In=function(e){var t=e.comment,n=e.post,r=e.setComments,a=Object(c.useState)(),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)({}),u=Object(Se.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!1),f=Object(Se.a)(b,2),v=f[0],O=f[1],m=Object(c.useState)(!1),p=Object(Se.a)(m,2),h=p[0],x=p[1],g=Object(c.useState)(!1),N=Object(Se.a)(g,2),y=N[0],_=N[1],C=Object(c.useState)([]),k=Object(Se.a)(C,2),I=k[0],w=k[1],A=Object(c.useState)(!1),E=Object(Se.a)(A,2),S=E[0],R=E[1],T=Object(c.useState)([]),F=Object(Se.a)(T,2),L=F[0],D=F[1],P=Object(c.useState)(!1),U=Object(Se.a)(P,2),M=U[0],q=U[1],B=Object(Ie.c)((function(e){return e.network})).socket,V=Object(Ie.c)((function(e){return e.auth})).userCurrent,Q=Object(c.useRef)(Object(mt.a)());Object(c.useEffect)((function(){var e=function(e){S&&R(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[S]),Object(c.useEffect)((function(){o(null===t||void 0===t?void 0:t.likes.length),q(null===t||void 0===t?void 0:t.likes.includes(V._id))}),[null===t||void 0===t?void 0:t.likes,null===V||void 0===V?void 0:V._id]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ze("/user?userId=".concat(null===t||void 0===t?void 0:t.userId));case 3:c=n.sent,r=c.user,e&&j(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ze("/comment/get-all-comments-reply/".concat(null===t||void 0===t?void 0:t._id));case 3:c=n.sent,c.message,r=c.comments,e&&w(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return v&&n(),function(){return e=!1}}),[v]);var J=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!M){e.next=7;break}return e.next=4,ze("/comment/unlike-comment/".concat(t._id),{userId:V._id});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,ze("/comment/like-comment/".concat(t._id),{userId:V._id});case 9:e.t0=e.sent;case 10:n=e.t0,c=n.message,Re.b.success(c,{autoClose:1e3}),e.next=18;break;case 15:e.prev=15,e.t1=e.catch(0),console.log("err",e.t1);case 18:q(!M),o(M?i-1:i+1);case 20:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(c,r){var a,s,i,o,l;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),e.prev=1,r||L.length){e.next=4;break}return e.abrupt("return",Re.b.info("Please enter data to comment",{autoClose:2e3}));case 4:return a={postId:null===n||void 0===n?void 0:n._id,userId:null===d||void 0===d?void 0:d._id,text:r},e.next=7,ot(L);case 7:return s=e.sent,a.images=Object(Ue.a)(s),e.next=11,Xe("/comment",a);case 11:return i=e.sent,o=i.comment,l=i.message,e.next=15,Xe("/comment/add-comment-reply/".concat(null===t||void 0===t?void 0:t._id),{commentReplyId:o._id});case 15:e.sent,v&&w((function(e){return[o].concat(Object(Ue.a)(e))})),D([]),O(!0),Re.b.success(l,{autoClose:2e3}),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),console.log("err",e.t0);case 25:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t,n){return e.apply(this,arguments)}}(),H=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xe("/post/remove-comment/".concat(null===n||void 0===n?void 0:n._id),{commentId:null===t||void 0===t?void 0:t._id,userId:null===V||void 0===V?void 0:V._id});case 3:c=e.sent,a=c.message,Re.b.success(a,{autoClose:2e3}),r((function(e){return e.filter((function(e){return e._id!==t._id}))})),null===B||void 0===B||B.emit("commentPostHandler",{type:"remove",comment:t,postId:null===n||void 0===n?void 0:n._id,userPost:n.userId,message:(null===V||void 0===V?void 0:V.userName)+" deleted the comment on your post"}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("div",{className:"commentLeft",children:Object(De.jsx)(dt,{user:d})}),Object(De.jsxs)("div",{className:"commentRight",children:[Object(De.jsxs)("div",{className:"commentRightTop",children:[Object(De.jsx)(Nn,{post:n,user:d,comment:t,isEdit:h,setIsEdit:x,setMessages:r}),(null===t||void 0===t?void 0:t.userId)===(null===V||void 0===V?void 0:V._id)&&Object(De.jsxs)("div",{className:"commentCrud",onClick:function(){return R(!S)},children:[Object(De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAHVJREFUSEtjZKAxYKSx+QyjFhAM4dEgGqFB5MDAwDAf6vdEBgaGA1A2qeJgbdhS0QMGBgZ5qKEgtiISmxRxnBZ8YGBg4Ica+pCBgUEByiZVHKcFoKBYADU0AS2ISBHHaQHBpEeKgtGcTDC0RoNoNIgIhgBBBQBNkxgZxgF3rgAAAABJRU5ErkJggg=="}),S&&Object(De.jsx)(yn,{id:null===t||void 0===t?void 0:t._id,onRemoveComment:H,setIsEdit:x})]})]}),Object(De.jsxs)("div",{className:"commentAction",children:[Object(De.jsxs)("div",{className:"commentLikeContainer",children:[Object(De.jsx)("span",{className:"commentLike ".concat(M&&"like"),onClick:J,children:"Like"}),Object(De.jsx)("span",{className:"commentNumberLike",children:i})]}),Object(De.jsx)("span",{className:"reply",onClick:function(){_(!y)},children:"Reply"}),Object(De.jsx)("span",{className:"commentDate",children:nt.a(null===t||void 0===t?void 0:t.createdAt)}),Object(De.jsx)("span",{className:"showFeedback",onClick:function(){return O(!v)},children:"feedbacks"}),t.isEdit&&Object(De.jsx)("span",{className:"showIsEdit",children:"Edited"})]}),Object(De.jsxs)("div",{className:"comentBottom",children:[y&&Object(De.jsx)(kn,{id:Q.current,files:L,setFiles:D,user:V,onCreateComment:Y}),v&&I.map((function(e){return Object(De.jsx)(Cn,{comment:t,setCommentsReply:w,commentReply:e},null===e||void 0===e?void 0:e._id)}))]}),Object(De.jsx)(_n,{text:"this comment ?",id:null===t||void 0===t?void 0:t._id,onRemove:H})]})]})},wn=(n(661),function(e){var t=e.id,n=e.setIsEdit,c=Object(i.m)();return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("button",{className:"detailPost",onClick:function(){return c("/post/"+t)},children:"Detail Post"}),Object(De.jsx)("button",{className:"updatePost",onClick:function(){return n((function(e){return!e}))},children:"Edit"}),Object(De.jsx)("button",{type:"button",className:"removePost","data-toggle":"modal","data-target":"#"+t,children:"Remove"})]})})}),An=(n(662),n(730)),En=n(732),Sn=function(e){var t=e.setIsTakePhoto,n=e.isTakePhoto,r=e.files,a=e.height,s=e.width,i=e.id,o=e.multiple,l=e.setFiles,u=Object(c.useRef)(),d=Object(c.useRef)(),j=Object(c.useState)(),b=Object(Se.a)(j,2),f=b[0],v=b[1],O=Object(c.useState)(!0),m=Object(Se.a)(O,2),p=m[0],h=m[1],x=Object(c.useState)(""),g=Object(Se.a)(x,2),N=g[0],y=g[1],_=Object(c.useState)(!1),C=Object(Se.a)(_,2),k=C[0],I=C[1],w=Object(c.useRef)({video:{width:{min:1280,ideal:1920,max:2560},height:{min:720,ideal:1080,max:1440}}}),A=function(){f&&f.getTracks().forEach((function(e){e.stop()}))},E=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(),w.current.video.facingMode=p?"user":"environment",e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia(w.current);case 5:t=e.sent,u.current.srcObject=t,u.current.play(),v(t),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),y("An error occurred while starting the camera");case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e;return n?!1 in navigator||!1 in navigator.mediaDevices?void y("Not support API camera"):(E(),function(){var e;null===u||void 0===u||null===(e=u.current)||void 0===e||e.srcObject.getTracks().forEach((function(e){e.stop()}))}):(null===u||void 0===u||null===(e=u.current)||void 0===e||e.pause(),A(),void v())}),[n,p]);return Object(De.jsxs)("div",{children:[Object(De.jsxs)("div",{className:"optionUploadImage",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){return t(!1)},children:"Upload photos"}),Object(De.jsx)("button",{type:"button",className:"btn btn-info",onClick:function(){return t(!0)},children:"Take a photo"})]}),Object(De.jsxs)("div",{className:"uploadImageContent",children:[n?Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:"takeVideoTop",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){k?u.current.play():u.current.pause(),I((function(e){return!e}))},children:"".concat(k?"Play":"Stop"," video")}),Object(De.jsx)("button",{type:"button",className:"btn btn-warning",onClick:function(){d.current.width=u.current.videoWidth,d.current.height=u.current.videoHeight,d.current.getContext("2d").drawImage(u.current,0,0);var e=d.current.toDataURL("image/png");l(o?function(t){return[].concat(Object(Ue.a)(t),[{camera:!0,url:e,uuid:Object(mt.a)()}])}:[{camera:!0,url:e,uuid:Object(mt.a)()}])},children:"Shot"}),Object(De.jsx)("button",{type:"button",className:"btn btn-dark",onClick:function(){h((function(e){return!e}))},children:"Change camera"})]}),Object(De.jsxs)("div",{className:"takeVideoBody",children:[N||Object(De.jsx)("video",{ref:u}),Object(De.jsx)("canvas",{style:{display:"none"},ref:d})]})]}):Object(De.jsxs)("div",{className:"uploadImageContentTop",children:[Object(De.jsxs)("label",{htmlFor:"file".concat(i),className:"shareOption",children:[Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Choose photo"})]}),Object(De.jsx)("input",{multiple:o,style:{display:" none"},type:"file",id:"file".concat(i),accept:".png,.jpeg,.jpg",onChange:function(e){var t=Array.from(e.target.files).map((function(e){return e.uuid=Object(mt.a)(),e}));l(o?function(e){return[].concat(Object(Ue.a)(e),Object(Ue.a)(t))}:Object(Ue.a)(t))}})]}),Object(De.jsx)("div",{className:"uploadImageContentBody",children:Object(De.jsx)("div",{className:"shareImgContainer",children:r.map((function(e){return Object(De.jsx)("div",{className:"imgContainer",style:{width:s,height:a},children:Object(De.jsx)(xn,{file:e,setFiles:l})},e.uuid)}))})})]})]})},Rn=function(e){var t=e.setPosts,n=e.post,r=e.setIsEdit,a=Object(c.useState)(null===n||void 0===n?void 0:n.images),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)((null===n||void 0===n?void 0:n.desc)||""),u=Object(Se.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)([]),f=Object(Se.a)(b,2),v=f[0],O=f[1],m=Object(c.useState)(!1),p=Object(Se.a)(m,2),h=p[0],x=p[1],g=Object(c.useRef)(Object(mt.a)()),N=Object(Ie.c)((function(e){return e.network})).socket,y=Object(Ie.c)((function(e){return e.auth})).userCurrent,_=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r,a,s,o,l;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=Object(Ue.a)(i),(r=null===n||void 0===n?void 0:n.images.filter((function(e){return!c.find((function(t){return e.url===t.url}))}))).length&&lt(r.map((function(e){return e.public_id}))),e.next=6,ot(v);case 6:return a=e.sent,c=[].concat(Object(Ue.a)(c),Object(Ue.a)(a)),e.next=10,ze("/post/".concat(null===n||void 0===n?void 0:n._id),{desc:d,images:c,userId:y._id});case 10:s=e.sent,o=s.message,l=s.newPost,Re.b.success(o,{autoClose:2e3}),t((function(e){return e.map((function(e){return e._id===l._id?l:e}))})),null===N||void 0===N||N.emit("postHandler",{type:"updatePost",post:l,userFollowings:null===y||void 0===y?void 0:y.followings,message:"".concat(null===y||void 0===y?void 0:y.userName," just edit a new post")}),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0),console.log("err",e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}(),C=function(){o(null===n||void 0===n?void 0:n.images),j((null===n||void 0===n?void 0:n.desc)||""),O([]),r(!1)};return Object(De.jsx)(De.Fragment,{children:Object(De.jsxs)(An.a,{show:!0,onHide:C,className:"modalEditContainer",children:[Object(De.jsx)(An.a.Header,{closeButton:!0,children:Object(De.jsx)(An.a.Title,{children:"Edit Post"})}),Object(De.jsxs)(An.a.Body,{className:"modalEditPostBody",children:[Object(De.jsx)("div",{className:"editDescPost",children:Object(De.jsx)("textarea",{className:"editDescPostInput",value:d,onChange:function(e){return j(e.target.value)},autoFocus:!0,row:1e3})}),Object(De.jsxs)("div",{className:"editImgPost",children:[Object(De.jsx)("div",{className:"editImgPostTop",children:Object(De.jsxs)("div",{className:"shareOption",children:[Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Posted photo"})]})}),Object(De.jsx)("div",{className:"disPlayImgCreateComment",children:i.map((function(e){return Object(De.jsx)("div",{className:"imgContainer",children:Object(De.jsx)(xn,{image:e.url,setImages:o})},e.url)}))}),Object(De.jsx)(Sn,{setIsTakePhoto:x,isTakePhoto:h,files:v,id:g.current,multiple:!0,setFiles:O})]})]}),Object(De.jsxs)(An.a.Footer,{children:[Object(De.jsx)(En.a,{variant:"secondary",onClick:C,children:"Close"}),Object(De.jsx)(En.a,{variant:"primary",onClick:function(){_(),C()},children:"Save Changes"})]})]})})};function Tn(e){var t=e.post,n=e.setPosts,r=e.className,a=Object(c.useState)(null===t||void 0===t?void 0:t.likes.length),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)(!1),u=Object(Se.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)({}),f=Object(Se.a)(b,2),v=f[0],O=f[1],m=Object(c.useState)(!1),p=Object(Se.a)(m,2),h=p[0],x=p[1],g=Object(c.useState)([]),N=Object(Se.a)(g,2),y=N[0],_=N[1],C=Object(c.useState)(!1),k=Object(Se.a)(C,2),I=k[0],w=k[1],A=Object(c.useState)(!1),E=Object(Se.a)(A,2),S=E[0],R=E[1],T=Object(c.useState)(!1),F=Object(Se.a)(T,2),L=F[0],D=F[1],P=Object(c.useState)([]),U=Object(Se.a)(P,2),M=U[0],q=U[1],B=Object(Ie.c)((function(e){return e.network})).socket,V=Object(Ie.c)((function(e){return e.auth})).userCurrent,Q=Object(c.useRef)(Object(mt.a)());Object(c.useEffect)((function(){var e=function(e){S&&R(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[S]),Object(c.useEffect)((function(){j(null===t||void 0===t?void 0:t.likes.includes(V._id)),o(null===t||void 0===t?void 0:t.likes.length)}),[null===t||void 0===t?void 0:t.likes,null===V||void 0===V?void 0:V._id]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ze("/post/get-all-comment/".concat(null===t||void 0===t?void 0:t._id));case 3:c=n.sent,c.message,r=c.comments,e&&_(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return I&&n(),function(){return e=!1}}),[I,null===t||void 0===t?void 0:t.comments]),Object(c.useEffect)((function(){var e=!0;if((null===V||void 0===V?void 0:V._id)!==(null===t||void 0===t?void 0:t.userId)){var n=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ze("/user?userId=".concat(null===t||void 0===t?void 0:t.userId));case 3:n=e.sent,c=n.user,O(c),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();n()}else e&&O(V);return function(){return e=!1}}),[V,null===t||void 0===t?void 0:t.userId]),Object(c.useEffect)((function(){var e=function(e){var n=e.type,c=(e.message,e.postId);(null===t||void 0===t?void 0:t._id)===c&&o((function(e){return"like"===n?e+1:e-1}))},n=function(e){e.message;var n=e.postId,c=e.type,r=e.comment;(null===t||void 0===t?void 0:t._id)===n&&_((function(e){return"remove"===c?e.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===r||void 0===r?void 0:r._id)})):"update"===c?e.map((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===r||void 0===r?void 0:r._id)?e:r})):[r].concat(Object(Ue.a)(e))}))};return B&&(B.on("updateLikePost",e),B.on("updateCommentPost",n)),function(){null===B||void 0===B||B.off("getNotify",e),null===B||void 0===B||B.off("updateCommentPost",n)}}),[B]);var J=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c,r,a;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!d){e.next=7;break}return e.next=4,ze("/post/dislike-post/".concat(t._id),{userId:V._id});case 4:e.t0=e.sent,e.next=10;break;case 7:return e.next=9,ze("/post/like-post/".concat(t._id),{userId:V._id});case 9:e.t0=e.sent;case 10:if(n=e.t0,c=n.message,Re.b.success(c,{autoClose:2e3}),d||(null===t||void 0===t?void 0:t.userId)===(null===V||void 0===V?void 0:V._id)){e.next=19;break}return e.next=16,Xe("/notification",{link:"/post/"+(null===t||void 0===t?void 0:t._id),receiverId:null===t||void 0===t?void 0:t.userId,text:(null===V||void 0===V?void 0:V.userName)+" liked on your post",senderId:null===V||void 0===V?void 0:V._id});case 16:r=e.sent,a=r.notification,null===B||void 0===B||B.emit("createNotification",{notification:a});case 19:j((function(e){return!e})),o((function(e){return d?e-1:e+1})),e.next=26;break;case 23:e.prev=23,e.t1=e.catch(0),console.log("err",e.t1);case 26:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(n,c){var r,a,s,i,o,l,u;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.prev=1,r={postId:null===t||void 0===t?void 0:t._id,userId:null===V||void 0===V?void 0:V._id,text:c,images:[]},e.next=5,ot(M);case 5:return a=e.sent,r.images=Object(Ue.a)(a),e.next=9,Xe("/comment",r);case 9:return s=e.sent,i=s.comment,o=s.message,e.next=13,Xe("/post/add-comment/".concat(null===t||void 0===t?void 0:t._id),{commentId:null===i||void 0===i?void 0:i._id});case 13:return e.sent,Re.b.success(o,{autoClose:2e3}),e.next=17,Xe("/notification",{link:"/post/"+(null===t||void 0===t?void 0:t._id),receiverId:null===t||void 0===t?void 0:t.userId,text:(null===V||void 0===V?void 0:V.userName)+" commented on your post",senderId:null===V||void 0===V?void 0:V._id});case 17:l=e.sent,u=l.notification,null===B||void 0===B||B.emit("createNotification",{notification:u}),_((function(e){return[i].concat(Object(Ue.a)(e))})),q([]),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(1),console.log("err",e.t0);case 27:case"end":return e.stop()}}),e,null,[[1,24]])})));return function(t,n){return e.apply(this,arguments)}}(),H=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var c,r;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,et("/post/".concat(null===t||void 0===t?void 0:t._id));case 3:c=e.sent,r=c.message,Re.b.success(r,{autoClose:2e3}),n((function(e){return e.filter((function(e){return e._id!==(null===t||void 0===t?void 0:t._id)}))})),B.emit("postHandler",{type:"remove",post:t,userFollowings:null===V||void 0===V?void 0:V.followings,message:"".concat(null===V||void 0===V?void 0:V.userName," just edit a new post")}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("err",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:r||"post",children:[Object(De.jsxs)("div",{className:"postWrapper",children:[Object(De.jsxs)("div",{className:"postTop",children:[Object(De.jsxs)("div",{className:"postTopLeft",children:[Object(De.jsx)(dt,{user:v,width:"50px",height:"50px"}),Object(De.jsx)("span",{className:"postUsername",children:null===v||void 0===v?void 0:v.userName}),Object(De.jsx)("span",{className:"postDate",children:nt.a(null===t||void 0===t?void 0:t.createdAt)})]}),(null===t||void 0===t?void 0:t.userId)===(null===V||void 0===V?void 0:V._id)&&Object(De.jsxs)("div",{className:"postTopRight",children:[Object(De.jsx)("span",{className:"CrudPost",onClick:function(){return R(!S)},children:Object(De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAFBJREFUSEtjZKAxYKSx+Qwjy4L/aMFJlO+JUgQ1eNQC2iRYUuKALBeQYsFoJBMMYpoHEUEXYFNASiTT3AKaB9GoBWTFIUFNgyoVEXTtgOQDAEM9DBleh0KcAAAAAElFTkSuQmCC"})}),S&&Object(De.jsx)("div",{className:"postCrudAction",children:Object(De.jsx)(wn,{id:null===t||void 0===t?void 0:t._id,setIsEdit:D})})]})]}),Object(De.jsxs)("div",{className:"postCenter",children:[Object(De.jsx)("span",{className:"postText",children:null===t||void 0===t?void 0:t.desc}),Object(De.jsx)("div",{className:"postImgContainer",children:null===t||void 0===t?void 0:t.images.map((function(e,n){return Object(De.jsx)("div",{className:"postImg",style:{width:"".concat(t.images.length%2!==0&&n===t.images.length-1?"100%":"calc(100%/2)")},children:Object(De.jsx)("img",{src:e.url,alt:""})},e.url)}))})]}),Object(De.jsxs)("div",{className:"postBottom",children:[Object(De.jsxs)("div",{className:"postBottomLeft",children:[Object(De.jsx)("img",{className:"likeIcon",src:"".concat(Le,"/like.png"),onClick:Tt(J,2e3),alt:""}),Object(De.jsx)("img",{className:"likeIcon",src:"".concat(Le,"/heart.png"),onClick:Tt(J,2e3),alt:""}),Object(De.jsxs)("span",{className:"postLikeCounter",children:[i," people like it"]})]}),Object(De.jsxs)("div",{className:"postBottomRight",onClick:function(){w(!I),x(!h)},children:[Object(De.jsx)("span",{className:"postCommentIcon",children:Object(De.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAIdJREFUSEvtlcENgCAMRR+TqJs4ik6mbuIoOommRpKGoB5aPMGV9n36IZ9A4RUK89ECPTABrVF0A0ZgFY4WkI3GCI/twupSgcMJHjHX4fUEVSB1uFr0+eaqRdWiTwdeC/aYyiWySOBDLq512C13kW2OhzR1g+fi2hWeCsxetmhff/30zReaA5yXYh0Zr3VkxgAAAABJRU5ErkJggg=="})}),Object(De.jsx)("span",{className:"postCommentText",children:"comments"})]})]}),Object(De.jsxs)("div",{className:"commentContainer",children:[h&&Object(De.jsx)(kn,{id:Q.current,files:M,setFiles:q,user:v,onCreateComment:Y}),Object(De.jsx)("div",{className:"displayComment",children:I&&y.map((function(e){return Object(De.jsx)("div",{className:"comment",children:Object(De.jsx)(In,{setComments:_,post:t,comment:e})},e._id)}))})]})]}),L&&Object(De.jsx)(Rn,{setPosts:n,setIsEdit:D,post:t})]}),Object(De.jsx)(_n,{onRemove:H,id:null===t||void 0===t?void 0:t._id,text:"this post ?"})]})}n(665);var Fn=n(725),Ln=n(726),Dn=n(727),Pn=function(e){var t=e.height,n=e.width,r=e.id,a=e.text,s=e.multiple,i=e.typeImage,o=e.onSave,l=Object(c.useState)([]),u=Object(Se.a)(l,2),d=u[0],j=u[1],b=Object(c.useState)(!1),f=Object(Se.a)(b,2),v=f[0],O=f[1];return Object(De.jsx)(De.Fragment,{children:Object(De.jsx)("div",{className:"modal fade",id:r,tabIndex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(De.jsx)("div",{className:"modal-dialog chooseImgage",role:"document",children:Object(De.jsxs)("div",{className:"modal-content",children:[Object(De.jsxs)("div",{className:"modal-header",children:[Object(De.jsx)("h5",{className:"modal-title",id:"exampleModalLabel",children:"".concat(a)}),Object(De.jsx)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:function(){O(!1)},children:Object(De.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(De.jsx)("div",{className:"modal-body",children:Object(De.jsx)(Sn,{setIsTakePhoto:O,isTakePhoto:v,files:d,height:t,width:n,setFiles:j,multiple:s,id:r})}),Object(De.jsxs)("div",{className:"modal-footer",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-danger",onClick:function(){o(d,i),j([]),O(!1)},"data-dismiss":"modal",children:"Save"}),Object(De.jsx)("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:function(){O(!1)},children:"Close"})]})]})})})})};function Un(e){var t=e.setPosts,n=Object(Ie.c)((function(e){return e.network})).socket,r=Object(Ie.c)((function(e){return e.auth})).userCurrent,a=Object(c.useState)(!1),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(c.useState)([]),u=Object(Se.a)(l,2),d=u[0],j=u[1],b=Object(c.useRef)(),f=Object(c.useRef)(Object(mt.a)()),v=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(c){var a,s,l,u,f,v,O;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),!i){e.next=3;break}return e.abrupt("return");case 3:if(d.length||b.current.value){e.next=5;break}return e.abrupt("return",Re.b.info("Please enter information to create a post",{autoClose:1e3}));case 5:return o(!0),a={desc:b.current.value,userId:null===r||void 0===r?void 0:r._id,images:[]},e.next=9,ot(d);case 9:return s=e.sent,a.images=s,e.prev=11,e.next=14,Xe("/post",a);case 14:return l=e.sent,u=l.message,f=l.post,b.current.value="",Re.b.success(u,{autoClose:2e3}),e.next=20,Promise.all(r.followings.map((function(e){return Xe("/notification",{link:"/post/"+(null===f||void 0===f?void 0:f._id),receiverId:e,text:(null===r||void 0===r?void 0:r.userName)+" created a new post",senderId:null===r||void 0===r?void 0:r._id})})));case 20:v=e.sent,O=[],v.forEach((function(e){var t;return O.push(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.notification)})),null===n||void 0===n||n.emit("createPost",{dataEmit:O}),t((function(e){return[f].concat(Object(Ue.a)(e))})),j([]),o(!1),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(11),console.log("err",e.t0);case 32:case"end":return e.stop()}}),e,null,[[11,29]])})));return function(t){return e.apply(this,arguments)}}();return Object(De.jsxs)("div",{className:"share",children:[Object(De.jsxs)("div",{className:"shareWrapper",children:[Object(De.jsxs)("div",{className:"shareTop",children:[Object(De.jsx)(dt,{user:r,width:"50px",height:"50px"}),Object(De.jsx)("input",{required:!0,placeholder:"What's in your mind ".concat(null===r||void 0===r?void 0:r.userName," ?"),className:"shareInput",ref:b})]}),Object(De.jsx)("hr",{className:"shareHr"}),Object(De.jsxs)("form",{className:"",onSubmit:v,children:[Object(De.jsxs)("div",{className:"shareBottom",children:[Object(De.jsxs)("div",{className:"shareOptions",children:[Object(De.jsxs)("button",{type:"button","data-target":"#".concat(f.current),"data-toggle":"modal",className:"shareOption",style:{border:0,outline:0,backgroundColor:"transparent"},children:[Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Photo or Video"})]}),Object(De.jsxs)("div",{className:"shareOption",children:[Object(De.jsx)(Fn.a,{htmlColor:"blue",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Tag"})]}),Object(De.jsxs)("div",{className:"shareOption",children:[Object(De.jsx)(Ln.a,{htmlColor:"green",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Location"})]}),Object(De.jsxs)("div",{className:"shareOption",children:[Object(De.jsx)(Dn.a,{htmlColor:"goldenrod",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:"Feelings"})]})]}),Object(De.jsx)("button",{type:"submit",className:"shareButton ".concat(i?"isShareing":""),children:"Share"})]}),Object(De.jsx)("div",{className:"shareImgContainer",children:d.map((function(e){return Object(De.jsx)("div",{className:"imgContainer",children:Object(De.jsx)(xn,{file:e,setFiles:j})},e.uuid)}))})]})]}),Object(De.jsx)(Pn,{onSave:function(e){j((function(t){return[].concat(Object(Ue.a)(t),Object(Ue.a)(e))}))},height:"150px",multiple:!0,id:f.current,text:"Choose a photo for the post"})]})}n(666);function Mn(e){var t=e.userName,n=Object(c.useState)([]),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(Ie.c)((function(e){return e.network})).socket,o=Object(Ie.c)((function(e){return e.auth})),l=o.userCurrent;o.accessToken;return Object(c.useEffect)((function(){var e=function(e){var t=e.post,n=e.type,c=e.message;Re.b.info(c,{autoClose:2e3}),s((function(e){return"removePost"===n?e.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===t||void 0===t?void 0:t._id)})):"updatePost"===n?e.map((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===t||void 0===t?void 0:t._id)?e:t})):[t].concat(Object(Ue.a)(e))}))};return i&&i.on("updateFeed",e),function(){null===i||void 0===i||i.off("updateFeed",e)}}),[i]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!(t||null!==l&&void 0!==l&&l._id)){n.next=14;break}if(!t){n.next=8;break}return n.next=5,Ze("/post/profile/".concat(t));case 5:n.t0=n.sent,n.next=11;break;case 8:return n.next=10,Ze("/post/get-all-post/".concat(null===l||void 0===l?void 0:l._id));case 10:n.t0=n.sent;case 11:c=n.t0,r=c.posts,e&&s(r.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)})));case 14:n.next=18;break;case 16:n.prev=16,n.t1=n.catch(0);case 18:case"end":return n.stop()}}),n,null,[[0,16]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t,null===l||void 0===l?void 0:l._id]),Object(De.jsxs)("div",{className:"feedWrapper",children:[(!t||t===(null===l||void 0===l?void 0:l.userName))&&Object(De.jsx)(Un,{setPosts:s}),a.map((function(e){return Object(De.jsx)(Tn,{setPosts:s,post:e},e._id)}))]})}n(667);var qn=function(e){var t=e.onEdit,n=Object(Ie.c)((function(e){return e.auth})).userCurrent,r=Object(Ie.b)(),a=Object(c.useRef)(),s=Object(c.useRef)(),i=Object(c.useRef)(),o=Object(c.useRef)(),l=Object(c.useRef)(),u=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(c){var u,d,j;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.preventDefault(),a.current.value){e.next=3;break}return e.abrupt("return",Re.b.error("This field cannot be left blank",{autoClose:1e3}));case 3:return e.prev=3,u={userName:a.current.value,phone:s.current.value,address:i.current.value,relationship:l.current.value,desc:o.current.value,userId:null===n||void 0===n?void 0:n._id},e.next=7,$e("/user/update-user",u);case 7:d=e.sent,d.message,j=d.user,r({type:b,payload:j}),t(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[3,13]])})));return function(t){return e.apply(this,arguments)}}();return Object(De.jsxs)("form",{className:"edit-profile",onSubmit:u,children:[Object(De.jsxs)("div",{className:"page",children:[Object(De.jsxs)("label",{className:"field field_v1",children:[Object(De.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.userName)||"",ref:a,className:"field__input",placeholder:"e.g Coder Noob"}),Object(De.jsx)("span",{className:"field__label-wrap",children:Object(De.jsx)("span",{className:"field__label",children:"Full name"})})]}),Object(De.jsxs)("label",{className:"field field_v2",children:[Object(De.jsx)("input",{defaultValue:null===n||void 0===n?void 0:n.email,className:"field__input",placeholder:"abc@gmail.com",disabled:!0}),Object(De.jsx)("span",{className:"field__label-wrap",children:Object(De.jsx)("span",{className:"field__label",children:"Email"})})]}),Object(De.jsxs)("label",{className:"field field_v3",children:[Object(De.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.address)||"",ref:i,className:"field__input",placeholder:"e.g Nam Dinh, Viet Nam"}),Object(De.jsx)("span",{className:"field__label-wrap",children:Object(De.jsx)("span",{className:"field__label",children:"Address"})})]}),Object(De.jsxs)("label",{className:"field field_v2",children:[Object(De.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.phone)||"",ref:s,className:"field__input",placeholder:"e.g (+84) 0399738474"}),Object(De.jsx)("span",{className:"field__label-wrap",children:Object(De.jsx)("span",{className:"field__label",children:"Phone"})})]}),Object(De.jsxs)("label",{className:"field field_v3",children:[Object(De.jsx)("input",{defaultValue:(null===n||void 0===n?void 0:n.desc)||"",ref:o,className:"field__input",placeholder:"Fill in what you like"}),Object(De.jsx)("span",{className:"field__label-wrap",children:Object(De.jsx)("span",{className:"field__label",children:"Description"})})]}),Object(De.jsxs)("div",{className:"input-group mb-3",children:[Object(De.jsx)("div",{className:"input-group-prepend",children:Object(De.jsx)("label",{className:"input-group-text",htmlFor:"inputGroupSelect01",children:"Relationship"})}),Object(De.jsxs)("select",{ref:l,className:"custom-select",id:"inputGroupSelect01",children:[Object(De.jsx)("option",{value:"",selected:!0,children:"Choose..."}),Object(De.jsx)("option",{value:"Single",children:"Single"}),Object(De.jsx)("option",{value:"Get married",children:"Get married"}),Object(De.jsx)("option",{value:"Dating",children:"Dating"}),Object(De.jsx)("option",{value:"In a complicated relationship",children:"In a complicated relationship"})]})]})]}),Object(De.jsxs)("div",{className:"linktr",children:[Object(De.jsx)("button",{type:"button",className:"btn btn-danger",onClick:function(){return t(!1)},children:"Cancel"}),Object(De.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Save"})]})]})},Bn=function(e){var t=e.onEdit,n=Object(Ie.c)((function(e){return e.auth})).userCurrent,c=Object(Ie.c)((function(e){return e.profile})).userProfile;return Object(De.jsx)("div",{className:"col-12",children:Object(De.jsx)("div",{className:"card mb-3",children:Object(De.jsxs)("div",{className:"card-body",children:[Object(De.jsxs)("div",{className:"row",children:[Object(De.jsx)("div",{className:"col-sm-3",children:Object(De.jsx)("h6",{className:"mb-0",children:"Full Name"})}),Object(De.jsx)("div",{className:"col-sm-9 text-secondary",children:null===c||void 0===c?void 0:c.userName})]}),Object(De.jsx)("hr",{}),Object(De.jsxs)("div",{className:"row",children:[Object(De.jsx)("div",{className:"col-sm-3",children:Object(De.jsx)("h6",{className:"mb-0",children:"Email"})}),Object(De.jsx)("div",{className:"col-sm-9 text-secondary",children:null===c||void 0===c?void 0:c.email})]}),Object(De.jsx)("hr",{}),Object(De.jsxs)("div",{className:"row",children:[Object(De.jsx)("div",{className:"col-sm-3",children:Object(De.jsx)("h6",{className:"mb-0",children:"Phone"})}),Object(De.jsx)("div",{className:"col-sm-9 text-secondary",children:null!==c&&void 0!==c&&c.phone?null===c||void 0===c?void 0:c.phone:"Not updated information"})]}),Object(De.jsx)("hr",{}),Object(De.jsxs)("div",{className:"row",children:[Object(De.jsx)("div",{className:"col-sm-3",children:Object(De.jsx)("h6",{className:"mb-0",children:"Relationship"})}),Object(De.jsx)("div",{className:"col-sm-9 text-secondary",children:null!==c&&void 0!==c&&c.relationship?null===c||void 0===c?void 0:c.relationship:"Not updated information"})]}),Object(De.jsx)("hr",{}),Object(De.jsxs)("div",{className:"row",children:[Object(De.jsx)("div",{className:"col-sm-3",children:Object(De.jsx)("h6",{className:"mb-0",children:"Address"})}),Object(De.jsx)("div",{className:"col-sm-9 text-secondary",children:null!==c&&void 0!==c&&c.address?null===c||void 0===c?void 0:c.address:"Not updated information"})]}),Object(De.jsx)("hr",{}),(null===c||void 0===c?void 0:c._id)===(null===n||void 0===n?void 0:n._id)&&Object(De.jsx)("div",{className:"row",children:Object(De.jsx)("div",{className:"col-12",children:Object(De.jsx)("button",{className:"btn btn-info",onClick:function(){return t(!0)},children:"Edit"})})})]})})})},Vn=function(e){e.user;var t=Object(c.useState)(!1),n=Object(Se.a)(t,2),r=n[0],a=n[1];return Object(De.jsx)(De.Fragment,{children:r?Object(De.jsx)(qn,{onEdit:a}):Object(De.jsx)(Bn,{onEdit:a})})},Qn=(n(668),function(){var e=Object(c.useState)([]),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(Ie.c)((function(e){return e.auth})).userCurrent,s=Object(Ie.c)((function(e){return e.profile})).userProfile;return Object(c.useEffect)((function(){var e=!0,t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n,c;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s||!s._id){t.next=12;break}return t.prev=1,t.next=4,Ze("/user/get-friends/".concat(null===s||void 0===s?void 0:s._id));case 4:n=t.sent,n.message,c=n.friends,e&&r(c),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),console.log("err",t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return t(),function(){return e=!1}}),[null===s||void 0===s?void 0:s._id,a]),Object(De.jsx)("div",{className:"row friend-container",children:Object(De.jsx)(vt,{children:n.map((function(e){var t;return Object(De.jsx)("div",{children:Object(De.jsxs)("div",{className:"our-friend",children:[Object(De.jsx)("div",{className:"picture",children:Object(De.jsx)("img",{className:"img-fluid",src:(null===e||void 0===e||null===(t=e.profilePicture)||void 0===t?void 0:t.length)&&(null===e||void 0===e?void 0:e.profilePicture[0])||Te})}),Object(De.jsxs)("div",{className:"friend-content",children:[Object(De.jsx)("p",{className:"name",children:null===e||void 0===e?void 0:e.userName}),Object(De.jsx)("h4",{className:"title",children:null===e||void 0===e?void 0:e.desc})]}),Object(De.jsxs)("ul",{className:"social",children:[Object(De.jsx)("li",{children:Object(De.jsx)("i",{className:"fa-brands fa-facebook-square"})}),Object(De.jsx)("li",{children:Object(De.jsx)("i",{className:"fa-brands fa-twitter-square"})}),Object(De.jsx)("li",{children:Object(De.jsx)("i",{className:"fa-brands fa-youtube-square"})}),Object(De.jsx)("li",{children:Object(De.jsx)("i",{className:"fa-brands fa-github-square"})})]})]})},null===e||void 0===e?void 0:e._id)}))})})}),Jn=function(e){var t=e.option,n=e.setOption;return Object(De.jsx)("ul",{className:"nav",children:["friends","about","posts","share","moreOption"].map((function(e){return Object(De.jsx)("li",{className:"".concat(t===e?"choose":""),onClick:function(){return n(e)},children:e[0].toUpperCase()+e.slice(1)},e)}))})},Yn=function(){var e=Object(Ie.c)((function(e){return e.auth})).userCurrent,t=Object(Ie.c)((function(e){return e.profile})).userProfile,n=Object(c.useState)((function(){return(null===e||void 0===e?void 0:e.followings.includes(null===t||void 0===t?void 0:t._id))||!1})),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(Ie.b)();Object(c.useEffect)((function(){e&&s(null===e||void 0===e?void 0:e.followings.includes(null===t||void 0===t?void 0:t._id))}),[e,t]);var o=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===t||void 0===t||!t._id){n.next=21;break}if(n.prev=1,!a){n.next=9;break}return n.next=5,ze("/user/unfollow/".concat(t._id),{userId:e._id});case 5:c=n.sent,i({type:f,payload:t._id}),n.next=13;break;case 9:return n.next=11,ze("/user/follow/".concat(t._id),{userId:e._id});case 11:c=n.sent,i({type:v,payload:t._id});case 13:r=c.message,Re.b.success(r,{autoClose:2e3}),s(!a),n.next=21;break;case 18:n.prev=18,n.t0=n.catch(1),console.log("err",n.t0);case 21:case"end":return n.stop()}}),n,null,[[1,18]])})));return function(){return n.apply(this,arguments)}}();return Object(De.jsx)("button",{className:"card__action__button card__action--follow",onClick:o,children:a?"Unfollow":"Follow"})},Hn=function(){var e=Object(c.useState)(),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(""),s=Object(Se.a)(a,2),i=s[0],o=s[1],l=Object(Ie.c)((function(e){return e.auth})).userCurrent,u=Object(Ie.c)((function(e){return e.profile})),d=u.userProfile,j=u.isFriend,b=Object(Ie.c)((function(e){return e.network})).socket,f=Object(c.useRef)(Object(mt.a)()),v=Object(c.useRef)(Object(mt.a)()),O=Object(Ie.b)();Object(c.useEffect)((function(){var e=function(e){O({type:p,payload:e})},t=function(e){O({type:h,payload:e})},n=function(e){var t=e.status,n=e.friendRequest;t?(o(t),r(n)):(o(""),r())};return b&&(b.on("addListFriend",e),b.on("removeListFriend",t),b.on("updateStatus",n)),function(){null===b||void 0===b||b.off("addListFriend",e),null===b||void 0===b||b.off("removeListFriend",t),null===b||void 0===b||b.off("updateStatus",n)}}),[b]),Object(c.useEffect)((function(){var e=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Ze("/friend-request?friendId=".concat(null===d||void 0===d?void 0:d._id,"&type=sender&status=1")),Ze("/friend-request?friendId=".concat(null===d||void 0===d?void 0:d._id,"&type=receive&status=1"))]);case 2:return t=e.sent,n="",t.forEach((function(e){e.message;var t=e.friendRequestDb,c=e.type;t&&(r(t),n=c)})),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=function(){var t=Object(Ee.a)(Object(Ae.a)().mark((function t(){var n;return Object(Ae.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!d||!l){t.next=9;break}if(!j){t.next=5;break}o("friend"),t.next=9;break;case 5:return t.next=7,e();case 7:n=t.sent,o(n);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[d,l]);var m=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n,c,a,s;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xe("/friend-request",{receiverId:null===d||void 0===d?void 0:d._id});case 3:return t=e.sent,n=t.message,c=t.friendRequestDb,Re.b.success(n,{autoClose:1e3}),r(c),o("sender"),null===b||void 0===b||b.emit("changeFriendRequest",{friendId:null===d||void 0===d?void 0:d._id,friendRequest:c,status:"receiver"}),e.next=11,Xe("/notification",{link:"/profile/".concat(null===l||void 0===l?void 0:l._id),receiverId:null===d||void 0===d?void 0:d._id,text:(null===l||void 0===l?void 0:l.userName)+" sent a friend request",senderId:null===l||void 0===l?void 0:l._id});case 11:a=e.sent,s=a.notification,null===b||void 0===b||b.emit("createNotification",{notification:s}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log("err",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=11;break}return e.next=4,et("/friend-request/".concat(null===n||void 0===n?void 0:n._id));case 4:t=e.sent,t.message,r(),o(""),null===b||void 0===b||b.emit("changeFriendRequest",{friendId:null===d||void 0===d?void 0:d._id,status:""}),e.next=12;break;case 11:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("err",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=12;break}return e.next=4,ze("/friend-request/refuse-request",{friendRequestId:null===n||void 0===n?void 0:n._id});case 4:t=e.sent,c=t.message,Re.b.success(c,{autoClose:1e3}),r(),o(""),null===b||void 0===b||b.emit("changeFriendRequest",{friendId:null===d||void 0===d?void 0:d._id,status:""}),e.next=13;break;case 12:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log("err",e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c,a,s;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=18;break}return e.next=4,ze("/friend-request/accept-friend-request",{friendId:null===d||void 0===d?void 0:d._id,friendRequestId:null===n||void 0===n?void 0:n._id});case 4:return t=e.sent,c=t.message,Re.b.success(c,{autoClose:1e3}),r(),o("friend"),O({type:p,payload:null===d||void 0===d?void 0:d._id}),O({type:le,payload:!0}),e.next=13,Xe("/notification",{link:"/profile/".concat(null===l||void 0===l?void 0:l._id),receiverId:null===d||void 0===d?void 0:d._id,text:(null===l||void 0===l?void 0:l.userName)+" has accept friend request",senderId:null===l||void 0===l?void 0:l._id});case 13:a=e.sent,s=a.notification,null===b||void 0===b||b.emit("acceptFriendRequest",{friendId:null===d||void 0===d?void 0:d._id,userId:null===l||void 0===l?void 0:l._id,notification:s}),e.next=19;break;case 18:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(0),console.log("err",e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n||"friend"!==i){e.next=13;break}return e.next=4,ze("/friend-request/unfriend",{friendId:null===d||void 0===d?void 0:d._id});case 4:t=e.sent,c=t.message,Re.b.success(c,{autoClose:1e3}),o(""),O({type:h,payload:null===d||void 0===d?void 0:d._id}),O({type:le,payload:!1}),null===b||void 0===b||b.emit("removeFriend",{friendId:null===d||void 0===d?void 0:d._id,userId:null===l||void 0===l?void 0:l._id}),e.next=14;break;case 13:Re.b.error("An error occurred while making this request!!!",{autoClose:1e3});case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log("err",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[i?"friend"===i?Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("button",{className:"card__action__button card__action--friend",children:"friend"}),Object(De.jsx)("button",{"data-toggle":"modal","data-target":"#".concat(v.current),className:"card__action__button card__action--unfriend",children:"Unfriend"})]}):Object(De.jsx)(De.Fragment,{children:"sender"===i?Object(De.jsx)(De.Fragment,{children:Object(De.jsx)("button",{"data-toggle":"modal","data-target":"#".concat(f.current),className:"card__action__button card__action--deleteRequestFriend",children:"Cancel friend request"})}):Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)("button",{className:"card__action__button card__action--acceptFriendRequset",onClick:N,children:"Accept friend request"}),Object(De.jsx)("button",{className:"card__action__button card__action--refuseFriendRequset",onClick:g,children:"Refuse friend request"})]})}):Object(De.jsx)(De.Fragment,{children:Object(De.jsx)("button",{className:"card__action__button card__action--addFriend",onClick:m,children:"add friend"})}),Object(De.jsx)(_n,{id:f.current,text:"Are you sure you want to cancel this friend request?",onRemove:x}),Object(De.jsx)(_n,{id:v.current,text:"You definitely want to unfriend ".concat(null===d||void 0===d?void 0:d.userName),onRemove:y})]})},Kn=function(){var e=Object(c.useState)(!1),t=Object(Se.a)(e,2),n=t[0],r=t[1],a=Object(Ie.c)((function(e){return e.profile})),s=a.userProfile,i=a.isFriend,o=Object(Ie.c)((function(e){return e.chat})),l=o.listConversation,u=o.isChat,d=o.conversationChat;Object(c.useEffect)((function(){n&&u&&l&&j()}),[u,l,n]);var j=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Ze("conversation?receiverId=".concat(null===s||void 0===s?void 0:s._id,"&isFriend=").concat(!!i));case 5:if(t=e.sent,t.message,(null===(n=t.conversation)||void 0===n?void 0:n._id)!==(null===d||void 0===d?void 0:d._id)){e.next=9;break}return e.abrupt("return");case 9:null!==l&&void 0!==l&&l.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===n||void 0===n?void 0:n._id)}))||b({type:M,payload:{conversation:n}}),b({type:J,payload:{conversationChat:n}}),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("err",e.t0);case 16:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(){return e.apply(this,arguments)}}(),b=Object(Ie.b)();return Object(De.jsx)("button",{className:"card__action__button card__action--message",onClick:function(){r(!0),b({type:T,payload:{isChat:!0}})},children:"message"})},Gn=(n(669),function(){var e=Object(Ie.c)((function(e){return e.profile})).isMe;return Object(De.jsx)(De.Fragment,{children:e?Object(De.jsx)(De.Fragment,{}):Object(De.jsxs)("div",{className:"card-profile__action",children:[Object(De.jsx)(Hn,{}),Object(De.jsx)(Yn,{}),Object(De.jsx)(Kn,{})]})})}),Wn=function(){var e=Object(c.useState)("friends"),t=Object(Se.a)(e,2),n=t[0],r=t[1];return Object(De.jsxs)("div",{className:"right col-lg-8",children:[Object(De.jsx)(Gn,{}),Object(De.jsx)(Jn,{option:n,setOption:r}),Object(De.jsxs)("div",{className:"display-content",children:["about"===n&&Object(De.jsx)(Vn,{}),"friends"===n&&Object(De.jsx)(Qn,{})]})]})},Zn=(n(670),function(){return Object(De.jsxs)("ul",{className:"button-socials",children:[Object(De.jsx)("li",{children:Object(De.jsx)("span",{className:"facebook",children:Object(De.jsx)("i",{className:"fab fa-facebook ","aria-hidden":"true"})})}),Object(De.jsx)("li",{children:Object(De.jsx)("span",{className:"twitter",children:Object(De.jsx)("i",{className:"fab fa-twitter ","aria-hidden":"true"})})}),Object(De.jsx)("li",{children:Object(De.jsx)("span",{className:"google",children:Object(De.jsx)("i",{className:"fab fa-google-plus-g ","aria-hidden":"true"})})}),Object(De.jsx)("li",{children:Object(De.jsx)("span",{className:"linkedin",children:Object(De.jsx)("i",{className:"fab fa-linkedin ","aria-hidden":"true"})})}),Object(De.jsx)("li",{children:Object(De.jsx)("span",{className:"instagram",children:Object(De.jsx)("i",{className:"fab fa-instagram ","aria-hidden":"true"})})})]})}),Xn=(n(671),function(e){var t=e.text,n=e.id,c=e.type;return Object(De.jsx)("div",{className:"updateImage ".concat(c),children:Object(De.jsxs)("button",{"data-toggle":"modal","data-target":"#".concat(n),className:"shareOption",children:[Object(De.jsx)(gn.a,{htmlColor:"tomato",className:"shareIcon"}),Object(De.jsx)("span",{className:"shareOptionText",children:t})]})})}),zn=function(e){var t,n,c,r=e.idAvatar,a=Object(Ie.c)((function(e){return e.profile})).userProfile,s=Object(Ie.c)((function(e){return e.auth})).userCurrent;return Object(De.jsxs)("div",{className:"left col-lg-4",children:[Object(De.jsxs)("div",{className:"photo-left",children:[Object(De.jsx)(dt,{className:"profile",width:"200px",height:"200px",user:a,isShowOffline:!1,link:!1}),(null===a||void 0===a?void 0:a._id)===(null===s||void 0===s?void 0:s._id)&&Object(De.jsx)(Xn,{id:r.current,type:"avatar"})]}),Object(De.jsx)("h4",{className:"name",children:null===a||void 0===a?void 0:a.userName}),Object(De.jsx)("p",{className:"info",children:null===a||void 0===a?void 0:a.email}),Object(De.jsxs)("div",{className:"stats row",children:[Object(De.jsxs)("div",{className:"stat col-4",children:[Object(De.jsx)("p",{className:"number-stat",children:null===a||void 0===a||null===(t=a.followers)||void 0===t?void 0:t.length}),Object(De.jsx)("p",{className:"desc-stat",children:"Followers"})]}),Object(De.jsxs)("div",{className:"stat col-4",children:[Object(De.jsx)("p",{className:"number-stat",children:null===a||void 0===a||null===(n=a.followings)||void 0===n?void 0:n.length}),Object(De.jsx)("p",{className:"desc-stat",children:"Following"})]}),Object(De.jsxs)("div",{className:"stat col-4",children:[Object(De.jsx)("p",{className:"number-stat",children:null===a||void 0===a||null===(c=a.friends)||void 0===c?void 0:c.length}),Object(De.jsx)("p",{className:"desc-stat",children:"Friend"})]})]}),Object(De.jsx)("p",{className:"desc",children:null===a||void 0===a?void 0:a.desc}),Object(De.jsx)(Zn,{})]})};n(672),n(673);function $n(e){var t=e.friend;return Object(De.jsxs)(tt.b,{to:"/profile/"+(null===t||void 0===t?void 0:t._id),className:"rightbarFriend",children:[Object(De.jsx)("div",{className:"rightbarProfileImgContainer",children:Object(De.jsx)(dt,{user:t,link:!1})}),Object(De.jsx)("span",{className:"rightbarUsername",children:null===t||void 0===t?void 0:t.userName})]})}var ec=n(728),tc=n(729);function nc(e){var t=e.user,n=Object(c.useState)([]),r=Object(Se.a)(n,2),a=r[0],s=r[1],i=Object(Ie.c)((function(e){return e.auth})).userCurrent,o=Object(Ie.c)((function(e){return e.network})).usersOnline,l=Object(Ie.b)(),u=Object(c.useState)((function(){return null===i||void 0===i?void 0:i.followings.includes(null===t||void 0===t?void 0:t._id)})),d=Object(Se.a)(u,2),j=d[0],b=d[1],O=Object(Ie.c)((function(e){return e.network})).socket;Object(c.useEffect)((function(){var e=!0;if(O){var t=function(t){var n=t.userDisconnectId,c=t.time;e&&s((function(e){return e.map((function(e){return(null===e||void 0===e?void 0:e._id)===n?Object(we.a)(Object(we.a)({},e),{},{lastLogin:c}):e}))}))};return O.on("friendLogout",t),function(){e=!1,null===O||void 0===O||O.off("friendLogout",t)}}}),[O]),Object(c.useEffect)((function(){a.length&&s((function(e){return e.map((function(e){return null!==o&&void 0!==o&&o.includes(null===e||void 0===e?void 0:e._id)?Object(we.a)(Object(we.a)({},e),{},{online:!0}):Object(we.a)(Object(we.a)({},e),{},{online:!1})}))}))}),[o]),Object(c.useEffect)((function(){b(null===i||void 0===i?void 0:i.followings.includes(null===t||void 0===t?void 0:t._id))}),[null===i||void 0===i?void 0:i.followings,null===t||void 0===t?void 0:t._id]),Object(c.useEffect)((function(){var e=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r,a;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t&&t._id||i&&i._id)){n.next=13;break}return n.prev=1,n.next=4,Ze("/user/get-friends/".concat((null===t||void 0===t?void 0:t._id)||(null===i||void 0===i?void 0:i._id)));case 4:c=n.sent,c.message,r=c.friends,a=r.map((function(e){return null!==o&&void 0!==o&&o.includes(e._id)?Object(we.a)(Object(we.a)({},e),{},{online:!0}):Object(we.a)(Object(we.a)({},e),{},{online:!1})})),e&&s(a),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),console.log("err",n.t0);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return e=!1}}),[t,i]);var m=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var n,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===t||void 0===t||!t._id){e.next=21;break}if(e.prev=1,!j){e.next=9;break}return e.next=5,ze("/user/unfollow/".concat(t._id),{userId:i._id});case 5:n=e.sent,l({type:f,payload:t._id}),e.next=13;break;case 9:return e.next=11,ze("/user/follow/".concat(t._id),{userId:i._id});case 11:n=e.sent,l({type:v,payload:t._id});case 13:c=n.message,Re.b.success(c,{autoClose:2e3}),b(!j),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(1),console.log("err",e.t0);case 21:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(){return e.apply(this,arguments)}}(),p=function(){return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)("div",{className:"birthdayContainer",children:[Object(De.jsx)("img",{className:"birthdayImg",src:Le+"gift.png",alt:""}),Object(De.jsx)("span",{className:"birthdayText"})]}),Object(De.jsx)("img",{className:"rightbarAd",src:Le+"ad.png",alt:""}),Object(De.jsx)("h4",{className:"rightbarTitle",children:"Friends"}),Object(De.jsx)("ul",{className:"rightbarFriendList",children:a.map((function(e){return Object(De.jsx)($n,{friend:e},null===e||void 0===e?void 0:e._id)}))})]})},h=function(){return Object(De.jsxs)(De.Fragment,{children:[(null===t||void 0===t?void 0:t.userName)!==(null===i||void 0===i?void 0:i.userName)&&Object(De.jsxs)("button",{className:"rightbarFollowButton",onClick:m,children:[j?"Unfollow":"Follow",j?Object(De.jsx)(ec.a,{}):Object(De.jsx)(tc.a,{})]}),Object(De.jsx)("h4",{className:"rightbarTitle",children:"User information"}),Object(De.jsxs)("div",{className:"rightbarInfo",children:[Object(De.jsxs)("div",{className:"rightbarInfoItem",children:[Object(De.jsx)("span",{className:"rightbarInfoKey",children:"City:"}),Object(De.jsx)("span",{className:"rightbarInfoValue",children:null===t||void 0===t?void 0:t.city})]}),Object(De.jsxs)("div",{className:"rightbarInfoItem",children:[Object(De.jsx)("span",{className:"rightbarInfoKey",children:"From:"}),Object(De.jsx)("span",{className:"rightbarInfoValue",children:null===t||void 0===t?void 0:t.from})]}),Object(De.jsxs)("div",{className:"rightbarInfoItem",children:[Object(De.jsx)("span",{className:"rightbarInfoKey",children:"Relationship:"}),Object(De.jsx)("span",{className:"rightbarInfoValue",children:1===(null===t||void 0===t?void 0:t.relationships)?"Single":2===(null===t||void 0===t?void 0:t.relationships)?"Marry":"In a complicated relationship"})]})]}),Object(De.jsx)("h4",{className:"rightbarTitle",children:"User friends"}),Object(De.jsx)("div",{className:"rightbarFollowings",children:a.map((function(e){var t;return Object(De.jsxs)("div",{className:"rightbarFollowing",children:[Object(De.jsx)(tt.b,{to:"/profile/".concat(null===e||void 0===e?void 0:e._id),children:Object(De.jsx)("img",{src:(null===e||void 0===e||null===(t=e.profilePicture)||void 0===t?void 0:t.length)&&(null===e||void 0===e?void 0:e.profilePicture[0])||Te,alt:"",className:"rightbarFollowingImg"})}),Object(De.jsx)("div",{className:"active ".concat(null!==e&&void 0!==e&&e.online?"online":"offline"," "),children:"8 hours"}),Object(De.jsx)("span",{className:"rightbarFollowingName",children:null===e||void 0===e?void 0:e.userName})]},e._id)}))})]})};return Object(De.jsx)("div",{className:"rightbar",children:t?Object(De.jsx)(h,{}):Object(De.jsx)(p,{})})}n(674);var cc=function(e){for(var t=e.split(" ").filter((function(e){return e})),n=t.length,c=[],r=[],a=[],s=0;s<n;s++)c[s]=!1;!function e(s){for(var i=0;i<n;i++)c[i]||(c[i]=!0,r[s]=t[i],s===n-1&&a.push(r.join(" ")),e(s+1),c[i]=!1)}(0);var i=a.reduce((function(e,t){var n=function(e){var t=[],n="";return e.split("").forEach((function(e){n+=e,t.push(n)})),t}(t);return[].concat(Object(Ue.a)(e),Object(Ue.a)(n))}),[]);return i};function rc(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(),a=Object(i.m)();return Object(De.jsx)("div",{className:"register",children:Object(De.jsxs)("div",{className:"registerWrapper",children:[Object(De.jsxs)("div",{className:"registerLeft",children:[Object(De.jsx)("h3",{className:"registerLogo",children:"CoderNoob"}),Object(De.jsx)("span",{className:"registerDesc",children:"Connect with friends and the world around you on CoderNoob."})]}),Object(De.jsx)("div",{className:"registerRight",children:Object(De.jsxs)("form",{className:"registerBox",onSubmit:function(c){if(c.preventDefault(),t.current.value!==r.current.value)r.current.setCustomValidity("Password don't match");else{var s=cc(n.current.value);wt({email:e.current.value,password:t.current.value,userName:n.current.value,keys:s},a)}},children:[Object(De.jsx)("input",{required:!0,ref:n,placeholder:"Username",className:"registerInput"}),Object(De.jsx)("input",{required:!0,ref:e,placeholder:"Email",type:"email",className:"registerInput"}),Object(De.jsx)("input",{type:"password",minLength:"6",required:!0,ref:t,placeholder:"Password",className:"registerInput"}),Object(De.jsx)("input",{type:"password",minLength:"6",required:!0,ref:r,placeholder:"Password Again",className:"registerInput"}),Object(De.jsx)("button",{className:"registerButton",children:"Sign Up"}),Object(De.jsx)(tt.b,{to:"/login",style:{display:"flex",justifyContent:"center"},children:Object(De.jsx)("button",{className:"registerRegisterButton",children:"Log into Account"})})]})})]})})}n(675);var ac=function(){return Object(De.jsxs)("div",{className:"pageNotFound",children:[Object(De.jsx)("h1",{children:"404 Error Page"}),Object(De.jsx)("p",{className:"zoom-area",children:Object(De.jsx)("b",{children:"Page Not Found"})}),Object(De.jsxs)("section",{className:"error-container",children:[Object(De.jsx)("span",{className:"four",children:Object(De.jsx)("span",{className:"screen-reader-text",children:"4"})}),Object(De.jsx)("span",{className:"zero",children:Object(De.jsx)("span",{className:"screen-reader-text",children:"0"})}),Object(De.jsx)("span",{className:"four",children:Object(De.jsx)("span",{className:"screen-reader-text",children:"4"})})]}),Object(De.jsx)("div",{className:"link-container",children:Object(De.jsx)(tt.b,{to:"/",className:"more-link",children:"Visit page Home"})})]})};n(312);var sc=function(e){var t=e.children,n=Object(c.useState)(!1),r=Object(Se.a)(n,2),a=r[0],s=r[1],o=Object(Ie.c)((function(e){return e.auth})).userCurrent,l=Object(i.m)(),u=Object(Ie.b)();return Object(c.useEffect)((function(){if(o)s(!0);else{var e=localStorage.getItem(Ve)?JSON.parse(localStorage.getItem(Ve)):"";if(!e)return l("/login");var t=Object(Be.a)(e),n=t.exp,c=t.userId;if(n<(new Date).getTime()/1e3||!c)return l("/login");var r=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,n;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ze("/user?userId=".concat(c));case 3:t=e.sent,t.message,n=t.user,u({type:b,payload:n}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0),l("/login");case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();r(),s(!0)}}),[]),a?Object(De.jsx)(De.Fragment,{children:t}):Object(De.jsx)(De.Fragment,{})},ic=(n(676),function(){var e=Object(i.o)().postId,t=Object(c.useState)(null),n=Object(Se.a)(t,2),r=n[0],a=n[1];return Object(c.useEffect)((function(){var t=!0,n=function(){var n=Object(Ee.a)(Object(Ae.a)().mark((function n(){var c,r;return Object(Ae.a)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Ze("/post/".concat(e));case 3:c=n.sent,r=c.post,t&&a(r),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("err",n.t0);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(){return n.apply(this,arguments)}}();return n(),function(){return t=!1}}),[e]),Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(ln,{}),Object(De.jsxs)("div",{className:"homeContainer",children:[Object(De.jsx)(hn,{}),Object(De.jsx)("div",{className:"postPageContainer",children:r&&Object(De.jsx)(Tn,{post:r,className:"postPage"})}),Object(De.jsx)(nc,{})]})]})}),oc=[{path:"/*",component:ac,layout:null,key:Object(mt.a)()},{path:"/login",component:function(){var e=Object(c.useRef)(),t=Object(c.useRef)(),n=Object(i.m)(),r=Object(Ie.b)(),a=Object(Ie.c)((function(e){return e.auth})).isLoading;return Object(De.jsx)("div",{className:"login",children:Object(De.jsxs)("div",{className:"loginWrapper",children:[Object(De.jsxs)("div",{className:"loginLeft",children:[Object(De.jsx)("h3",{className:"loginLogo",children:"Coder Noob"}),Object(De.jsx)("span",{className:"loginDesc",children:"Connect with friends and the world around you on CODE NOOB."})]}),Object(De.jsx)("form",{className:"loginRight",onSubmit:function(c){c.preventDefault(),r(It({userName:e.current.value,password:t.current.value},n))},children:Object(De.jsxs)("div",{className:"loginBox",children:[Object(De.jsx)("input",{required:!0,placeholder:"User name",ref:e,type:"text",className:"loginInput"}),Object(De.jsx)("input",{required:!0,placeholder:"Password",ref:t,type:"password",className:"loginInput",minLength:"6"}),Object(De.jsx)("button",{className:"loginButton",children:a?Object(De.jsx)(At.a,{color:"primary",size:"30px"}):"Log In"}),Object(De.jsx)("span",{className:"loginForgot",children:"Forgot Password?"}),Object(De.jsx)("button",{className:"loginRegisterButton",onClick:function(){return n("/register")},children:a?Object(De.jsx)(At.a,{color:"primary",size:"30px"}):"Create a New Account"})]})})]})})},key:Object(mt.a)(),layout:null},{path:"/register",component:rc,key:Object(mt.a)(),layout:null}],lc=[{path:"/",component:function(){return Object(De.jsxs)("div",{className:"wrapper",children:[Object(De.jsx)(ln,{}),Object(De.jsxs)("div",{className:"homeContainer",children:[Object(De.jsx)(hn,{}),Object(De.jsx)(Mn,{}),Object(De.jsx)(nc,{})]})]})},key:Object(mt.a)(),layout:sc},{path:"/messenger",component:rc,key:Object(mt.a)(),layout:sc},{path:"/profile/:id",component:function(){var e,t,n=Object(i.o)().id,r=Object(Ie.c)((function(e){return e.auth})).userCurrent,a=Object(Ie.c)((function(e){return e.profile})).userProfile,s=Object(c.useRef)(Object(mt.a)()),o=Object(c.useRef)(Object(mt.a)()),l=Object(Ie.b)();Object(c.useEffect)((function(){var e=!0;if(r)if((null===r||void 0===r?void 0:r._id)!==n){var t=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(){var t,c;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ze("/user?userId=".concat(n));case 3:t=e.sent,c=t.user,l({type:ue,payload:{userProfile:c,isFriend:null===c||void 0===c?void 0:c.friends.includes(null===r||void 0===r?void 0:r._id)}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("err",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();t()}else e&&l({type:de,payload:r});return function(){return e=!1}}),[r,n]);var u=function(){var e=Object(Ee.a)(Object(Ae.a)().mark((function e(t,n){var c,r,s,i,o;return Object(Ae.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return");case 2:return null!==(c=a[n])&&void 0!==c&&c.length&&lt([a[n][1]]),e.next=5,ot(t);case 5:for(o in s=e.sent,i=[],s[0])i.push(s[0][o]);return e.next=10,$e("/user/update-user",(r={},Object(Et.a)(r,n,i),Object(Et.a)(r,"userId",null===a||void 0===a?void 0:a._id),r));case 10:e.sent,l({type:"coverPicture"===n?O:m,payload:i});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(De.jsxs)(De.Fragment,{children:[Object(De.jsx)(ln,{}),Object(De.jsxs)("div",{className:"profile-container",children:[Object(De.jsxs)("div",{className:"profile-bgc",style:{backgroundImage:"url(".concat((null===a||void 0===a||null===(e=a.coverPicture)||void 0===e?void 0:e.length)&&(null===a||void 0===a?void 0:a.coverPicture[0])||Fe,")")},children:[Object(De.jsx)("i",{className:"fa fa-bars","aria-hidden":"true"}),(null===a||void 0===a?void 0:a._id)===(null===r||void 0===r?void 0:r._id)&&Object(De.jsx)(Xn,{id:s.current,text:"".concat(null!==a&&void 0!==a&&null!==(t=a.coverPicture)&&void 0!==t&&t.length&&null!==a&&void 0!==a&&a.coverPicture[0]?"Change":"Add"," cover photo"),type:"background"})]}),Object(De.jsx)("hr",{className:"separator separator--line"}),Object(De.jsx)("main",{children:Object(De.jsxs)("div",{className:"row",children:[Object(De.jsx)(zn,{idAvatar:o}),Object(De.jsx)(Wn,{})]})})]}),Object(De.jsx)(Pn,{onSave:u,width:"100%",multiple:!1,height:"300px",id:s.current,text:"Select the background image you want to update",typeImage:"coverPicture"}),Object(De.jsx)(Pn,{onSave:u,multiple:!1,width:"100%",height:"250px",id:o.current,text:"Select the avatar image you want to update",typeImage:"profilePicture"})]})},key:Object(mt.a)(),layout:sc},{path:"/post/:postId",component:ic,layout:sc,key:Object(mt.a)()}];var uc=function(){var e=Object(Ie.c)((function(e){return e.network})),t=e.firstConnect,n=e.socket,r=e.firstGetData,a=e.usersOnline,s=Object(Ie.c)((function(e){return e.auth})).userCurrent,u=Object(Ie.c)((function(e){return e.call})),d=u.isCall,j=(u.isInvited,Object(Ie.b)());return Object(c.useEffect)((function(){if(n){var e=function(e){var t=e.isVideo,n=e.userSendCall,c=e.roomCallId,r=e.isCreate,a=e.conversationId;j({type:je,payload:{isCall:!0,isVideo:t,userSendCall:n,roomCallId:c,isCreate:r,isSenderCall:!1,conversationId:a}})};return n.on("connectCall",e),function(){null===n||void 0===n||n.off("handleConnectCall",e)}}}),[n]),Object(c.useEffect)((function(){var e=new l.a(void 0,{host:"/",port:9e3});j({type:ge,payload:e})}),[j]),Object(c.useEffect)((function(){var e=function(e){a.includes(e)||j({type:K,payload:e})},t=function(e){var t=e.userDisconnectId;j({type:G,payload:t})};return n&&(n.on("friendOnline",e),n.on("friendLogout",t)),function(){null===n||void 0===n||n.off("friendOnline",e),null===n||void 0===n||n.off("friendLogout",t)}}),[n]),Object(c.useEffect)((function(){var e=function(e){j({type:p,payload:e})},t=function(e){j({type:h,payload:e})};return n&&(n.on("addListFriend",e),n.on("removeListFriend",t)),function(){null===n||void 0===n||n.off("addListFriend",e),null===n||void 0===n||n.off("removeListFriend",t)}}),[n]),Object(c.useEffect)((function(){t&&s&&j({type:Y,payload:Object(o.a)("ws://localhost:8900")})}),[s]),Object(c.useEffect)((function(){var e=function(e){if(r){var t=null===s||void 0===s?void 0:s.followings.filter((function(t){return e.find((function(e){return e===t}))}));j({type:H,payload:t})}};return n&&(n.emit("userLogin",{userId:null===s||void 0===s?void 0:s._id,friends:null===s||void 0===s?void 0:s.friends,userName:null===s||void 0===s?void 0:s.userName}),n.on("getUsers",e)),function(){null===n||void 0===n||n.off("getUsers",e)}}),[n,r]),Object(De.jsxs)(De.Fragment,{children:[Object(De.jsxs)(i.c,{children:[oc.map((function(e){var t=e.layout?e.layout:c.Fragment,n=e.component;return Object(De.jsx)(i.a,{path:e.path,element:Object(De.jsx)(t,{children:Object(De.jsx)(n,{})})},e.key)})),lc.map((function(e){var t=e.layout?e.layout:c.Fragment,n=e.component;return Object(De.jsx)(i.a,{path:e.path,element:Object(De.jsx)(t,{children:Object(De.jsx)(n,{})})},e.key)}))]}),d&&Object(De.jsx)(kt,{})]})},dc=(n(691),n(129)),jc=n(324),bc={userCurrent:null,isLoading:!1,error:null},fc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case x:return Object(we.a)({},bc);case d:return Object(we.a)(Object(we.a)({},e),{},{isLoading:!0});case u:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:c,isLoading:!1});case j:return Object(we.a)(Object(we.a)({},e),{},{isLoading:!1,userCurrent:null,error:c});case b:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:c});case f:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:Object(we.a)(Object(we.a)({},e.userCurrent),{},{followings:e.userCurrent.followings.filter((function(e){return e!==c}))})});case v:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:Object(we.a)(Object(we.a)({},e.userCurrent),{},{followings:[c].concat(Object(Ue.a)(e.userCurrent.followings))})});case m:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:Object(we.a)(Object(we.a)({},e.userCurrent),{},{profilePicture:Object(Ue.a)(c)})});case O:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:Object(we.a)(Object(we.a)({},e.userCurrent),{},{coverPicture:Object(Ue.a)(c)})});case p:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:Object(we.a)(Object(we.a)({},e.userCurrent),{},{friends:[c].concat(Object(Ue.a)(e.userCurrent.friends)),followings:[c].concat(Object(Ue.a)(e.userCurrent.followings))})});case h:return Object(we.a)(Object(we.a)({},e),{},{userCurrent:Object(we.a)(Object(we.a)({},e.userCurrent),{},{friends:e.userCurrent.friends.filter((function(e){return e!==c}))})});default:return e}},vc=n(13),Oc=["conversationId"],mc={lastMessageConversation:null,isChat:!1,number:0,conversationChat:null,conversationUnReads:[],listConversation:[],isShowConversationPending:!1},pc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case D:return Object(we.a)(Object(we.a)({},e),{},{isShowConversationPending:c});case xe:var r=c.conversationId,a=Object(vc.a)(c,Oc),s=e.listConversation;return Object(we.a)(Object(we.a)({},e),{},{listConversation:s.map((function(e){return e._id===r?Object(we.a)(Object(we.a)({},e),a):e}))});case E:return Object(we.a)(Object(we.a)({},e),{},{lastMessageConversation:c});case S:var i=c.conversationId,o=c.isRead;return Object(we.a)(Object(we.a)({},e),{},{statusConversations:e.statusConversations.map((function(e){return e.conversationId===i?Object(we.a)(Object(we.a)({},e),{},{isRead:o}):e}))});case R:return Object(we.a)(Object(we.a)({},e),{},{statusConversations:c});case T:return Object(we.a)(Object(we.a)(Object(we.a)({},e),c),{},{number:0});case F:var l=c.userId,u=c.conversations,d=[];return u.forEach((function(e){var t=e.reads,n=e.status,c=e._id;n.includes(l)&&(t.includes(l)||d.push(c))})),Object(we.a)(Object(we.a)({},e),{},{listConversation:u,conversationUnReads:d});case M:var j=c.conversation,b=e.listConversation;return Object(we.a)(Object(we.a)({},e),{},{listConversation:Zt(b,j,(function(e,t){return e.find((function(e){return e._id!==t._id}))}))});case Q:var f=c.conversationId,v=c.userId;return Object(we.a)(Object(we.a)({},e),{},{conversationAccepts:e.conversationAccepts.map((function(e){return e._id===f?Object(we.a)(Object(we.a)({},e),{},{reads:[].concat(Object(Ue.a)(e.reads),[v])}):e})),conversationDisplays:e.conversationDisplays.map((function(e){return e._id===f?Object(we.a)(Object(we.a)({},e),{},{reads:[].concat(Object(Ue.a)(e.reads),[v])}):e}))});case P:var O=e.conversationAccepts.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)}));if(O)return Object(we.a)({},e);var m=[c].concat(Object(Ue.a)(e.conversationAccepts)),p=e.conversationPendings.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===c||void 0===c?void 0:c._id)}));return Object(we.a)(Object(we.a)({},e),{},{conversationAccepts:m,conversationDisplays:m,conversationPendings:p});case L:var h=c.conversationChat,x=c.isChangeType,g=e.isShowConversationPending,N=e.listConversation;return Object(we.a)(Object(we.a)({},e),{},{listConversation:N.map((function(e){return e._id===h._id?h:e})),conversationChat:h,isShowConversationPending:x?!g:g});case J:var y=c.conversationChat;return Object(we.a)(Object(we.a)({},e),{},{conversationChat:y});case U:return Object(we.a)(Object(we.a)({},e),{},{friendChat:Object(we.a)(Object(we.a)({},e.friendChat),{},{lastLogin:c})});case q:return Object(we.a)(Object(we.a)({},e),{},{number:c});case B:return Object(we.a)(Object(we.a)({},e),{},{conversationUnReads:Zt(e.conversationUnReads,c)});case V:return Object(we.a)(Object(we.a)({},e),{},{number:e.number-1});default:return e}},hc={type:"received",listFriendRequest:null,number:0},xc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case g:return["received","sent"].includes(c)?Object(we.a)(Object(we.a)({},e),{},{type:c}):Object(we.a)({},e);case N:return Object(we.a)(Object(we.a)({},e),{},{listFriendRequest:c,number:c.length});case y:return e.listFriendRequest.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)}))?Object(we.a)({},e):Object(we.a)(Object(we.a)({},e),{},{listFriendRequest:[c].concat(Object(Ue.a)(e.listFriendRequest)),number:e.number+1});case _:return Object(we.a)(Object(we.a)({},e),{},{listFriendRequest:e.listFriendRequest.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==c})),number:e.number-1});case C:return Object(we.a)(Object(we.a)({},e),{},{number:e.number+1});case k:return Object(we.a)(Object(we.a)({},e),{},{number:c});default:return e}},gc={files:[]},Nc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case I:return Object(we.a)(Object(we.a)({},e),{},{files:c});case w:return e.files.find((function(e){return(null===e||void 0===e?void 0:e.uuid)===(null===c||void 0===c?void 0:c.uuid)}))?Object(we.a)({},e):Object(we.a)(Object(we.a)({},e),{},{files:[c].concat(Object(Ue.a)(e.files))});case A:return Object(we.a)(Object(we.a)({},e),{},{files:e.files.filter((function(e){return(null===e||void 0===e?void 0:e.uuid)!==c}))});default:return e}},yc={firstConnect:!0,socket:null,usersOnline:[],firstGetData:!0},_c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case W:return Object(we.a)({},yc);case Y:return Object(we.a)(Object(we.a)({},e),{},{socket:c,firstConnect:!1});case H:return Object(we.a)(Object(we.a)({},e),{},{usersOnline:c||[],firstGetData:!1});case K:return Object(we.a)(Object(we.a)({},e),{},{usersOnline:Zt(e.usersOnline,c)});case G:return Object(we.a)(Object(we.a)({},e),{},{usersOnline:e.usersOnline.filter((function(e){return e!==c}))});default:return e}},Cc={isShow:!1,isShowMenu:!1,number:0,listNotifycation:null,notificationDisplays:null,type:"all"},kc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case te:return Object(we.a)(Object(we.a)({},e),{},{isShow:c,number:0});case Z:return Object(we.a)(Object(we.a)({},e),{},{listNotifycation:c,notificationDisplays:c});case z:return Object(we.a)(Object(we.a)({},e),{},{number:c});case $:return Object(we.a)(Object(we.a)({},e),{},{number:e.number+1});case ee:return Object(we.a)(Object(we.a)({},e),{},{number:e.number-1});case X:return Object(we.a)(Object(we.a)({},e),{},{listNotifycation:Zt(e.listNotifycation,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))}))});case ie:return Object(we.a)(Object(we.a)({},e),{},{notificationDisplays:Zt(e.notificationDisplays,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))}))});case ne:return Object(we.a)(Object(we.a)({},e),{},{listNotifycation:e.listNotifycation.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==c})),notificationDisplays:e.notificationDisplays.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==c}))});case re:return Object(we.a)(Object(we.a)({},e),{},{notificationDisplays:c});case ce:return["all","read","unread"].includes(c)?Object(we.a)(Object(we.a)({},e),{},{type:c}):Object(we.a)({},e);case ae:return Object(we.a)(Object(we.a)({},e),{},{listNotifycation:[],notificationDisplays:[]});case se:return Object(we.a)(Object(we.a)({},e),{},{listNotifycation:e.listNotifycation.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)?c:e})),notificationDisplays:e.notificationDisplays.map((function(e){return(null===e||void 0===e?void 0:e._id)===(null===c||void 0===c?void 0:c._id)?c:e}))});case oe:return Object(we.a)(Object(we.a)({},e),{},{isShowMenu:!e.isShowMenu});default:return e}},Ic={isFriend:null,userProfile:null,isMe:!1},wc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ic,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case le:return Object(we.a)(Object(we.a)({},e),{},{isFriend:c});case ue:var r=c.userProfile,a=c.isFriend;return Object(we.a)(Object(we.a)({},e),{},{userProfile:r,isFriend:a});case de:return Object(we.a)(Object(we.a)({},e),{},{isMe:!0,userProfile:c});default:return e}},Ac={isVideo:null,isCall:null,userSendCall:null,userReciverCall:null,isSenderCall:!1,isAnswer:!1,friendInvites:[],fristLoadFriends:!0,isCreate:null,roomCallId:null,userStream:null,conversationId:null,isComplete:!1},Ec=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ac,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case he:return Object(we.a)(Object(we.a)({},e),{},{isComplete:!0});case pe:return Object(we.a)(Object(we.a)({},e),{},{userStream:c});case Oe:return Object(we.a)(Object(we.a)({},e),{},{isCreate:!1,isCall:!1,isVideo:null,userSendCall:null});case me:return Object(we.a)(Object(we.a)({},e),{},{isAnswer:!0,isCall:!0,isCreate:!1});case ve:return Object(we.a)(Object(we.a)({},e),{},{friendInvites:c,fristLoadFriends:!1});case je:return Object(we.a)(Object(we.a)({},e),c);case be:var r=e.userStream;if(r)r.getTracks().forEach((function(e){return e.stop()}));return Object(we.a)({},Ac);case fe:return Object(we.a)(Object(we.a)({},e),{},{isAnswer:c});default:return e}},Sc=null,Rc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;return n===ge?c:e},Tc={isCreate:!1,friends:[],friendAdds:[]},Fc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tc,t=arguments.length>1?arguments[1]:void 0,n=t.type,c=t.payload;switch(n){case ke:return Object(we.a)(Object(we.a)({},e),Tc);case Ce:return Object(we.a)(Object(we.a)({},e),{},{friends:c});case Ne:return Object(we.a)(Object(we.a)({},e),{},{isCreate:c});case ye:return Object(we.a)(Object(we.a)({},e),{},{friendAdds:Zt(e.friendAdds,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))})),friends:e.friends.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===c||void 0===c?void 0:c._id)}))});case _e:return Object(we.a)(Object(we.a)({},e),{},{friends:Zt(e.friends,c,(function(e,t){return e.find((function(e){return(null===e||void 0===e?void 0:e._id)===(null===t||void 0===t?void 0:t._id)}))})),friendAdds:e.friendAdds.filter((function(e){return(null===e||void 0===e?void 0:e._id)!==(null===c||void 0===c?void 0:c._id)}))});default:return e}},Lc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return{auth:fc(e.auth,t),chat:pc(e.chat,t),friendRequest:xc(e.friendRequest,t),message:Nc(e.message,t),network:_c(e.network,t),notification:kc(e.notification,t),profile:wc(e.profile,t),peer:Rc(e.peer,t),call:Ec(e.call,t),createRoomChat:Fc(e.createRoomChat,t)}},Dc=n(323),Pc=Object(Dc.composeWithDevTools)(Object(dc.applyMiddleware)(jc.a)),Uc=Object(dc.createStore)(Lc,Pc),Mc=(n(692),n(693),function(e){return e.children});s.a.render(Object(De.jsx)(Ie.a,{store:Uc,children:Object(De.jsxs)(r.a.StrictMode,{children:[Object(De.jsx)(tt.a,{children:Object(De.jsx)(Mc,{children:Object(De.jsx)(uc,{})})}),Object(De.jsx)(Re.a,{})]})}),document.getElementById("root"))}},[[694,1,2]]]);
//# sourceMappingURL=main.3bfb083e.chunk.js.map